[0m16:13:51.124786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65fe03550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65fc5ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65fe033d0>]}


============================== 16:13:51.155781 | 0abf1cda-14dd-4c0e-a3b2-e829c87568d5 ==============================
[0m16:13:51.155781 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:13:51.156675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088 --no-browser', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:13:51.645175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0abf1cda-14dd-4c0e-a3b2-e829c87568d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65fe02750>]}
[0m16:13:51.752705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0abf1cda-14dd-4c0e-a3b2-e829c87568d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe65fb06650>]}
[0m10:33:26.235964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d6dc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d6cb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d6cb890>]}


============================== 10:33:26.246629 | 89bf7ff3-c227-4476-96b1-44c93f24189b ==============================
[0m10:33:26.246629 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:33:26.247464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8088', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:33:26.787572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89bf7ff3-c227-4476-96b1-44c93f24189b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d757850>]}
[0m10:33:26.896135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89bf7ff3-c227-4476-96b1-44c93f24189b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015f44bb10>]}
[0m10:34:43.053620 [error] [MainThread]: Encountered an error:

[0m10:34:43.059802 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:34:43.062544 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 81.018364, "process_user_time": 2.678687, "process_kernel_time": 0.776431, "process_mem_max_rss": "109324", "process_in_blocks": "119624", "process_out_blocks": "2976", "command_success": false}
[0m10:34:43.064030 [debug] [MainThread]: Command `dbt docs serve` failed at 10:34:43.063855 after 81.02 seconds
[0m10:34:43.064894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01617fb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d757a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f015d517590>]}
[0m10:34:43.065577 [debug] [MainThread]: Flushing usage events
[0m10:36:11.878205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7db06f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7db06e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7db06fed0>]}


============================== 10:36:11.887064 | 975152c2-463c-446d-83de-74be40f2430a ==============================
[0m10:36:11.887064 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:36:11.887979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:12.205004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7db02b7d0>]}
[0m10:36:12.312870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dce3f950>]}
[0m10:36:12.313915 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m10:36:12.464110 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:36:12.621611 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:36:12.622402 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m10:36:12.623031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dc4a2550>]}
[0m10:36:14.719699 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:36:14.720561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dacd4c90>]}
[0m10:36:14.752822 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_sales_order' in the 'models' section of file 'models/marts/schema.yml'
[0m10:36:15.213901 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_order_id_WID.d3c869bc39' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.214783 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.unique_fact_sales_order_order_id_WID.d31a1fd111' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.215648 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_INTEGRATION_ID.f85856db36' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.216420 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_customer_id_WID.656829fb57' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.217076 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_customer_id_WID__customer_id_WID__ref_dim_customer_.5cd67266c1' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.217768 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_status_id_WID__order_status_id_WID__ref_dim_order_status_.231779f8eb' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.218374 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_order_date_key.7c50f7e4c8' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.218984 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_date_key__date_key__ref_dim_date_.ecc166e551' (models/marts/schema.yml) depends on a node named 'dim_date' in package '' which was not found
[0m10:36:15.219572 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_date_key__date_key__ref_dim_date_.ecc166e551' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.220137 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.dbt_utils_expression_is_true_fact_sales_order_total_due__total_due_0.ef0e70dc5d' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.220785 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_trino_project.dbt_utils_unique_combination_of_columns_fact_sales_order_order_id_WID.b54d2dcd2a' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m10:36:15.358586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m10:36:15.376982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7da904590>]}
[0m10:36:15.397632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7da6affd0>]}
[0m10:36:15.398461 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m10:36:15.399052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7da816c50>]}
[0m10:36:15.403628 [info ] [MainThread]: 
[0m10:36:15.404620 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:36:15.412333 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg_gold'
[0m10:36:15.540816 [debug] [ThreadPool]: Using trino connection "list_iceberg_gold"
[0m10:36:15.541541 [debug] [ThreadPool]: On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
[0m10:36:15.542097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:18.546863 [debug] [ThreadPool]: SQL status: SUCCESS in 3.005 seconds
[0m10:36:18.549684 [debug] [ThreadPool]: On list_iceberg_gold: ROLLBACK
[0m10:36:18.550306 [debug] [ThreadPool]: On list_iceberg_gold: Close
[0m10:36:18.554254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '975152c2-463c-446d-83de-74be40f2430a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7da916950>]}
[0m10:36:18.555351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:36:18.556183 [info ] [MainThread]: 
[0m10:36:18.582362 [debug] [Thread-1 (]: Began running node model.dbt_trino_project.dim_address
[0m10:36:18.584001 [debug] [Thread-2 (]: Began running node model.dbt_trino_project.dim_credit_card
[0m10:36:18.586089 [debug] [Thread-3 (]: Began running node model.dbt_trino_project.dim_customer
[0m10:36:18.587384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.dim_address)
[0m10:36:18.588223 [debug] [Thread-4 (]: Began running node model.dbt_trino_project.dim_order_status
[0m10:36:18.589812 [debug] [Thread-2 (]: Acquiring new trino connection 'model.dbt_trino_project.dim_credit_card'
[0m10:36:18.591264 [debug] [Thread-3 (]: Acquiring new trino connection 'model.dbt_trino_project.dim_customer'
[0m10:36:18.592443 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_project.dim_address
[0m10:36:18.593689 [debug] [Thread-4 (]: Acquiring new trino connection 'model.dbt_trino_project.dim_order_status'
[0m10:36:18.594779 [debug] [Thread-2 (]: Began compiling node model.dbt_trino_project.dim_credit_card
[0m10:36:18.595620 [debug] [Thread-3 (]: Began compiling node model.dbt_trino_project.dim_customer
[0m10:36:18.604054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_project.dim_address"
[0m10:36:18.605052 [debug] [Thread-4 (]: Began compiling node model.dbt_trino_project.dim_order_status
[0m10:36:18.612232 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_trino_project.dim_credit_card"
[0m10:36:18.620554 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_trino_project.dim_customer"
[0m10:36:18.627840 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_trino_project.dim_order_status"
[0m10:36:18.629418 [debug] [Thread-1 (]: Began executing node model.dbt_trino_project.dim_address
[0m10:36:18.632313 [debug] [Thread-1 (]: Finished running node model.dbt_trino_project.dim_address
[0m10:36:18.633736 [debug] [Thread-3 (]: Began executing node model.dbt_trino_project.dim_customer
[0m10:36:18.634601 [debug] [Thread-1 (]: Began running node model.dbt_trino_project.dim_product
[0m10:36:18.635524 [debug] [Thread-2 (]: Began executing node model.dbt_trino_project.dim_credit_card
[0m10:36:18.637281 [debug] [Thread-3 (]: Finished running node model.dbt_trino_project.dim_customer
[0m10:36:18.638157 [debug] [Thread-4 (]: Began executing node model.dbt_trino_project.dim_order_status
[0m10:36:18.638885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_address, now model.dbt_trino_project.dim_product)
[0m10:36:18.640493 [debug] [Thread-2 (]: Finished running node model.dbt_trino_project.dim_credit_card
[0m10:36:18.641546 [debug] [Thread-3 (]: Began running node model.dbt_trino_project.fact_sales
[0m10:36:18.643654 [debug] [Thread-4 (]: Finished running node model.dbt_trino_project.dim_order_status
[0m10:36:18.644477 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_project.dim_product
[0m10:36:18.645430 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
[0m10:36:18.646486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_customer, now model.dbt_trino_project.fact_sales)
[0m10:36:18.647681 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
[0m10:36:18.655628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_project.dim_product"
[0m10:36:18.656732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_credit_card, now test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563)
[0m10:36:18.657702 [debug] [Thread-3 (]: Began compiling node model.dbt_trino_project.fact_sales
[0m10:36:18.658715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_order_status, now test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f)
[0m10:36:18.659936 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
[0m10:36:18.667940 [debug] [Thread-1 (]: Began executing node model.dbt_trino_project.dim_product
[0m10:36:18.674340 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
[0m10:36:18.768616 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_trino_project.fact_sales"
[0m10:36:18.779766 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
[0m10:36:18.781090 [debug] [Thread-1 (]: Finished running node model.dbt_trino_project.dim_product
[0m10:36:18.787820 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
[0m10:36:18.789533 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
[0m10:36:18.790770 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
[0m10:36:18.791492 [debug] [Thread-3 (]: Began executing node model.dbt_trino_project.fact_sales
[0m10:36:18.792879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_product, now test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8)
[0m10:36:18.794130 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
[0m10:36:18.794666 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
[0m10:36:18.796089 [debug] [Thread-3 (]: Finished running node model.dbt_trino_project.fact_sales
[0m10:36:18.796776 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
[0m10:36:18.797598 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
[0m10:36:18.798826 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
[0m10:36:18.799659 [debug] [Thread-3 (]: Began running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
[0m10:36:18.807109 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
[0m10:36:18.808156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563, now test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172)
[0m10:36:18.809109 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
[0m10:36:18.810264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_trino_project.fact_sales, now test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978)
[0m10:36:18.811258 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
[0m10:36:18.812228 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f, now test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a)
[0m10:36:18.813107 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
[0m10:36:18.813916 [debug] [Thread-3 (]: Began compiling node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
[0m10:36:18.825743 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
[0m10:36:18.826755 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
[0m10:36:18.828107 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
[0m10:36:18.836498 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
[0m10:36:18.844464 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
[0m10:36:18.845558 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
[0m10:36:18.846379 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
[0m10:36:18.848751 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
[0m10:36:18.849740 [debug] [Thread-3 (]: Began executing node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
[0m10:36:18.850631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8, now test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800)
[0m10:36:18.851407 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
[0m10:36:18.852141 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
[0m10:36:18.853583 [debug] [Thread-3 (]: Finished running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
[0m10:36:18.854328 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
[0m10:36:18.855573 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
[0m10:36:18.856676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172, now test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165)
[0m10:36:18.857878 [debug] [Thread-3 (]: Began running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
[0m10:36:18.865600 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
[0m10:36:18.866496 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
[0m10:36:18.867647 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
[0m10:36:18.868937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978, now test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987)
[0m10:36:18.870329 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a, now test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa)
[0m10:36:18.876878 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
[0m10:36:18.878978 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
[0m10:36:18.879818 [debug] [Thread-3 (]: Began compiling node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
[0m10:36:18.880556 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
[0m10:36:18.881812 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
[0m10:36:18.890953 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
[0m10:36:18.899734 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
[0m10:36:18.909057 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
[0m10:36:18.910485 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
[0m10:36:18.912721 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
[0m10:36:18.914048 [debug] [Thread-3 (]: Began executing node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
[0m10:36:18.915212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800, now test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d)
[0m10:36:18.916196 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
[0m10:36:18.917215 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
[0m10:36:18.919163 [debug] [Thread-3 (]: Finished running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
[0m10:36:18.920239 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
[0m10:36:18.922204 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
[0m10:36:18.923638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165, now test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b)
[0m10:36:18.924925 [debug] [Thread-3 (]: Began running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
[0m10:36:18.933455 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
[0m10:36:18.934749 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
[0m10:36:18.935842 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
[0m10:36:18.936797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987, now test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d)
[0m10:36:18.937726 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa, now test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b)
[0m10:36:18.943946 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
[0m10:36:18.946200 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
[0m10:36:18.946904 [debug] [Thread-3 (]: Began compiling node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
[0m10:36:18.947700 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
[0m10:36:18.948912 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
[0m10:36:18.956412 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
[0m10:36:18.962697 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
[0m10:36:18.964367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
[0m10:36:18.965583 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
[0m10:36:18.967322 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
[0m10:36:18.968491 [debug] [Thread-3 (]: Began executing node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
[0m10:36:18.969305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d, now test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0)
[0m10:36:18.970282 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
[0m10:36:18.971192 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
[0m10:36:18.972721 [debug] [Thread-3 (]: Finished running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
[0m10:36:18.973494 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
[0m10:36:18.975149 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
[0m10:36:18.975971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b, now test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308)
[0m10:36:18.976801 [debug] [Thread-3 (]: Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
[0m10:36:18.983541 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
[0m10:36:18.984456 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
[0m10:36:18.985333 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
[0m10:36:18.986234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d, now test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1)
[0m10:36:18.987393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b, now test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477)
[0m10:36:18.994247 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
[0m10:36:18.994965 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
[0m10:36:18.995540 [debug] [Thread-3 (]: Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
[0m10:36:18.996275 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
[0m10:36:18.997744 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
[0m10:36:19.004156 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
[0m10:36:19.005205 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
[0m10:36:19.012255 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
[0m10:36:19.013229 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
[0m10:36:19.014492 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
[0m10:36:19.016186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0, now test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882)
[0m10:36:19.016962 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
[0m10:36:19.017724 [debug] [Thread-3 (]: Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
[0m10:36:19.018436 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
[0m10:36:19.019302 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
[0m10:36:19.020376 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
[0m10:36:19.021492 [debug] [Thread-3 (]: Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
[0m10:36:19.022554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308, now test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d)
[0m10:36:19.033154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
[0m10:36:19.033935 [debug] [Thread-4 (]: Began running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
[0m10:36:19.034873 [debug] [Thread-3 (]: Began running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
[0m10:36:19.035754 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
[0m10:36:19.036713 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477, now test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656)
[0m10:36:19.037501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1, now test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5)
[0m10:36:19.038087 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
[0m10:36:19.045463 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
[0m10:36:19.046431 [debug] [Thread-4 (]: Began compiling node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
[0m10:36:19.047232 [debug] [Thread-3 (]: Began compiling node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
[0m10:36:19.048496 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
[0m10:36:19.057450 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
[0m10:36:19.063945 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
[0m10:36:19.065716 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
[0m10:36:19.066577 [debug] [Thread-1 (]: Began running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
[0m10:36:19.068005 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
[0m10:36:19.069217 [debug] [Thread-4 (]: Began executing node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
[0m10:36:19.070023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882, now test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5)
[0m10:36:19.070714 [debug] [Thread-3 (]: Began executing node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
[0m10:36:19.071562 [debug] [Thread-2 (]: Began running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
[0m10:36:19.072920 [debug] [Thread-4 (]: Finished running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
[0m10:36:19.073715 [debug] [Thread-1 (]: Began compiling node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
[0m10:36:19.075001 [debug] [Thread-3 (]: Finished running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
[0m10:36:19.075822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d, now test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6)
[0m10:36:19.082690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
[0m10:36:19.083828 [debug] [Thread-2 (]: Began compiling node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
[0m10:36:19.091071 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
[0m10:36:19.092057 [debug] [Thread-1 (]: Began executing node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
[0m10:36:19.093322 [debug] [Thread-1 (]: Finished running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
[0m10:36:19.094301 [debug] [Thread-2 (]: Began executing node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
[0m10:36:19.095258 [debug] [Thread-2 (]: Finished running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
[0m10:36:19.097533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:19.098045 [debug] [MainThread]: Connection 'test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5' was properly closed.
[0m10:36:19.098503 [debug] [MainThread]: Connection 'test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6' was properly closed.
[0m10:36:19.099085 [debug] [MainThread]: Connection 'test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5' was properly closed.
[0m10:36:19.099533 [debug] [MainThread]: Connection 'test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656' was properly closed.
[0m10:36:19.104922 [debug] [MainThread]: Command end result
[0m10:36:19.284257 [debug] [MainThread]: Acquiring new trino connection 'generate_catalog'
[0m10:36:19.284879 [info ] [MainThread]: Building catalog
[0m10:36:19.293443 [debug] [ThreadPool]: Acquiring new trino connection 'iceberg.information_schema'
[0m10:36:19.403979 [debug] [ThreadPool]: Using trino connection "iceberg.information_schema"
[0m10:36:19.405395 [debug] [ThreadPool]: On iceberg.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "iceberg.information_schema"} */

    
        with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        table_type as "table_type",
        null as "table_owner"
    from "iceberg".INFORMATION_SCHEMA.tables
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_order_status'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesreason'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_creditcard'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_productcategory'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'fact_sales'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_credit_card'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_countryregion'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_stateprovince'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderdetail'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_person'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_customer'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderheadersalesreason'
                    )
                 or 
                    (
                        table_schema = 'bronze'
                        and table_name = 'silve_person_address'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_store'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_product'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_productsubcategory'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_address'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderheader'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_product'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_customer'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_address'
                    )
                )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from "iceberg".INFORMATION_SCHEMA.columns
            where
        table_schema != 'information_schema'
        and
        (
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_order_status'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesreason'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_creditcard'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_productcategory'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'fact_sales'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_credit_card'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_countryregion'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_stateprovince'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderdetail'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_person'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_customer'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderheadersalesreason'
                    )
                 or 
                    (
                        table_schema = 'bronze'
                        and table_name = 'silve_person_address'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_store'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_product'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_productsubcategory'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_person_address'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_salesorderheader'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_production_product'
                    )
                 or 
                    (
                        table_schema = 'silver'
                        and table_name = 'silver_sales_customer'
                    )
                 or 
                    (
                        table_schema = 'gold'
                        and table_name = 'dim_address'
                    )
                )
        ),
        table_comment as (
            
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'dim_order_status'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_salesreason'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_creditcard'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_production_productcategory'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'fact_sales'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'dim_credit_card'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_person_countryregion'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_person_stateprovince'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_salesorderdetail'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_person_person'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'dim_customer'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_salesorderheadersalesreason'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'bronze'
                    and table_name = 'silve_person_address'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_store'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'dim_product'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_production_productsubcategory'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_person_address'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_salesorderheader'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_production_product'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'silver'
                    and table_name = 'silver_sales_customer'
                )
            
    union all
    
    select
        catalog_name as "table_database",
        schema_name as "table_schema",
        table_name as "table_name",
        comment as "table_comment"
    from system.metadata.table_comments
    where
        catalog_name = 'iceberg'
        and
        schema_name != 'information_schema'
        and
        
                (
                    schema_name = 'gold'
                    and table_name = 'dim_address'
                )
            
        )
        select
            table_database,
            table_schema,
            table_name,
            table_type,
            table_owner,
            column_name,
            column_index,
            column_type,
            column_comment,
            table_comment
        from tables
        join columns using ("table_database", "table_schema", "table_name")
        join table_comment using ("table_database", "table_schema", "table_name")
        order by "column_index"
[0m10:36:19.406777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:29.474430 [debug] [ThreadPool]: SQL status: SUCCESS in 10.068 seconds
[0m10:36:29.498226 [debug] [ThreadPool]: On iceberg.information_schema: Close
[0m10:36:29.592303 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m10:36:29.594017 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 17.803247, "process_user_time": 6.215459, "process_kernel_time": 0.520364, "process_mem_max_rss": "130552", "process_in_blocks": "36816", "process_out_blocks": "7568"}
[0m10:36:29.594942 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:36:29.594799 after 17.80 seconds
[0m10:36:29.595464 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:36:29.595917 [debug] [MainThread]: Connection 'iceberg.information_schema' was properly closed.
[0m10:36:29.596449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dad001d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dad34e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7da7a99d0>]}
[0m10:36:29.596992 [debug] [MainThread]: Flushing usage events
[0m10:36:35.524206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e849a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e849a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e849bfd0>]}


============================== 10:36:35.533065 | 42479703-b7d7-4461-851a-dd625e7a1773 ==============================
[0m10:36:35.533065 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:36:35.533928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8088', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:35.848629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42479703-b7d7-4461-851a-dd625e7a1773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e82071d0>]}
[0m10:36:35.955813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42479703-b7d7-4461-851a-dd625e7a1773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ea216e10>]}
[0m10:38:44.238128 [error] [MainThread]: Encountered an error:

[0m10:38:44.241807 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:38:44.243577 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 134.30531, "process_user_time": 2.525376, "process_kernel_time": 0.199371, "process_mem_max_rss": "109836", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m10:38:44.244681 [debug] [MainThread]: Command `dbt docs serve` failed at 10:38:44.244521 after 134.31 seconds
[0m10:38:44.245468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ec5c7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e84a3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36e8163590>]}
[0m10:38:44.246160 [debug] [MainThread]: Flushing usage events
[0m10:41:40.884415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ba1d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ba1d1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ba1d1ed0>]}


============================== 10:41:40.892855 | 36bdd240-0df7-4f9f-8e43-b437ae33a596 ==============================
[0m10:41:40.892855 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:41:40.893741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:41.203361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36bdd240-0df7-4f9f-8e43-b437ae33a596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b9f3fe90>]}
[0m10:41:41.310101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36bdd240-0df7-4f9f-8e43-b437ae33a596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24b9f8ae90>]}
[0m14:40:57  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02ad31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02cd5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02ad0e10>]}
[0m14:40:57  Running with dbt=1.8.7
[0m14:40:57  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --profiles-dir . --target dev --quiet --resource-type model --output name --select dim_credit_card', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'text', 'send_anonymous_usage_stats': 'True'}
[0m14:40:58  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03efbc10>]}
[0m14:40:58  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd048a9a50>]}
[0m14:40:58  Registered adapter: trino=1.8.0
[0m14:40:58  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m14:40:58  Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:40:58  previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m14:40:58  Unable to do partial parsing because profile has changed
[0m14:40:58  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03f41190>]}
[0m14:41:00  [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:41:00  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02b5ded0>]}
[0m14:41:00  [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_sales_order' in the 'models' section of file 'models/marts/schema.yml'
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_order_id_WID.d3c869bc39' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.unique_fact_sales_order_order_id_WID.d31a1fd111' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_INTEGRATION_ID.f85856db36' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_customer_id_WID.656829fb57' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_customer_id_WID__customer_id_WID__ref_dim_customer_.5cd67266c1' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_status_id_WID__order_status_id_WID__ref_dim_order_status_.231779f8eb' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.not_null_fact_sales_order_order_date_key.7c50f7e4c8' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_date_key__date_key__ref_dim_date_.ecc166e551' (models/marts/schema.yml) depends on a node named 'dim_date' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.relationships_fact_sales_order_order_date_key__date_key__ref_dim_date_.ecc166e551' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.dbt_utils_expression_is_true_fact_sales_order_total_due__total_due_0.ef0e70dc5d' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Test 'test.dbt_trino_project.dbt_utils_unique_combination_of_columns_fact_sales_order_order_id_WID.b54d2dcd2a' (models/marts/schema.yml) depends on a node named 'fact_sales_order' in package '' which was not found
[0m14:41:01  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m14:41:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0202e190>]}
[0m14:41:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02056ed0>]}
[0m14:41:01  Found 6 models, 24 data tests, 15 sources, 564 macros
[0m14:41:01  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86b3cd3-0d21-42c2-ae3e-b0565e3c1006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd022116d0>]}
[0m14:41:01  Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 4.034208, "process_user_time": 5.567408, "process_kernel_time": 0.598646, "process_mem_max_rss": "123448", "process_in_blocks": "25480", "process_out_blocks": "2992"}
[0m14:41:01  Command `dbt ls` succeeded at 14:41:01.710107 after 4.04 seconds
[0m14:41:01  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02b3ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02b5bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd022121d0>]}
[0m14:41:01  Flushing usage events
14:41:06  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adf7bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adf78e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adf7b3d0>]}
14:41:06  Running with dbt=1.8.7
14:41:06  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'True', 'profiles_dir': '.', 'use_colors': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'text', 'invocation_command': 'dbt run --profiles-dir . --target dev --select dim_credit_card --debug --no-use-colors --fail-fast', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
14:41:06  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c855a44-366b-4ad0-be12-90e26a268025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ade206d0>]}
14:41:07  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c855a44-366b-4ad0-be12-90e26a268025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06afd49510>]}
14:41:07  Registered adapter: trino=1.8.0
14:41:07  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
14:41:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:41:07  Partial parsing enabled, no changes found, skipping parsing
14:41:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
14:41:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c855a44-366b-4ad0-be12-90e26a268025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adcede90>]}
14:41:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c855a44-366b-4ad0-be12-90e26a268025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ad8cf810>]}
14:41:08  Found 6 models, 24 data tests, 15 sources, 564 macros
14:41:08  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c855a44-366b-4ad0-be12-90e26a268025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06af3a5010>]}
14:41:08  
14:41:08  Acquiring new trino connection 'master'
14:41:08  Acquiring new trino connection 'list_iceberg'
14:41:08  Using trino connection "list_iceberg"
14:41:08  On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
14:41:08  Opening a new connection, currently in state init
14:41:09  On list_iceberg: Close
14:41:09  Connection 'master' was properly closed.
14:41:09  Connection 'list_iceberg' was properly closed.
14:41:09  
14:41:09  Finished running  in 0 hours 0 minutes and 0.74 seconds (0.74s).
14:41:09  Encountered an error:
Runtime Error
  error 401: b'Unauthorized'
14:41:09  Resource report: {"command_name": "run", "command_wall_clock_time": 2.5371199, "process_user_time": 3.367452, "process_kernel_time": 1.035365, "process_mem_max_rss": "119888", "process_in_blocks": "3872", "process_out_blocks": "1488", "command_success": false}
14:41:09  Command `dbt run` failed at 14:41:09.048107 after 2.54 seconds
14:41:09  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adf81150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06adf98c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ad9d5790>]}
14:41:09  Flushing usage events
[0m15:17:15.188173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb360150a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36014bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36014b790>]}


============================== 15:17:15.198167 | 99604f05-b5ca-4265-974e-577e13d43d19 ==============================
[0m15:17:15.198167 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:17:15.199132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir . --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:15.211670 [info ] [MainThread]: dbt version: 1.8.7
[0m15:17:15.212449 [info ] [MainThread]: python version: 3.11.10
[0m15:17:15.212989 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m15:17:15.213645 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m15:17:15.311479 [info ] [MainThread]: Using profiles dir at .
[0m15:17:15.312330 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m15:17:15.312860 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m15:17:15.313376 [info ] [MainThread]: adapter type: trino
[0m15:17:15.313895 [info ] [MainThread]: adapter version: 1.8.0
[0m15:17:15.489121 [info ] [MainThread]: Configuration:
[0m15:17:15.490103 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:17:15.490724 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:17:15.491252 [info ] [MainThread]: Required dependencies:
[0m15:17:15.491849 [debug] [MainThread]: Executing "git --help"
[0m15:17:15.506422 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:17:15.507394 [debug] [MainThread]: STDERR: "b''"
[0m15:17:15.508183 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:17:15.508830 [info ] [MainThread]: Connection:
[0m15:17:15.509657 [info ] [MainThread]:   host: trino-coordinator
[0m15:17:15.510578 [info ] [MainThread]:   port: 8443
[0m15:17:15.511382 [info ] [MainThread]:   user: data_engineer
[0m15:17:15.512326 [info ] [MainThread]:   database: iceberg
[0m15:17:15.513052 [info ] [MainThread]:   schema: silver
[0m15:17:15.513924 [info ] [MainThread]:   cert: None
[0m15:17:15.514729 [info ] [MainThread]:   prepared_statements_enabled: True
[0m15:17:15.515747 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m15:17:15.635584 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m15:17:15.688520 [debug] [MainThread]: Using trino connection "debug"
[0m15:17:15.689194 [debug] [MainThread]: On debug: select 1 as id
[0m15:17:15.689688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:16.881287 [debug] [MainThread]: SQL status: SUCCESS in 1.191 seconds
[0m15:17:16.882834 [debug] [MainThread]: On debug: Close
[0m15:17:16.885115 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:17:16.885749 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:17:16.887003 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7848974, "process_user_time": 2.625173, "process_kernel_time": 0.313134, "process_mem_max_rss": "112576", "process_in_blocks": "11976", "process_out_blocks": "40"}
[0m15:17:16.887821 [debug] [MainThread]: Command `dbt debug` succeeded at 15:17:16.887687 after 1.79 seconds
[0m15:17:16.888355 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:17:16.888886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36019d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35fefd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35fa23510>]}
[0m15:17:16.889430 [debug] [MainThread]: Flushing usage events
[0m15:19:51  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c9a34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c9a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c9a3410>]}
[0m15:19:51  Running with dbt=1.8.7
[0m15:19:51  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --profiles-dir . --target dev --quiet --resource-type model --output name --select dim_credit_card', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'text', 'send_anonymous_usage_stats': 'True'}
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f488608-eff1-4b8c-af90-dd3e7564701e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c791c90>]}
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f488608-eff1-4b8c-af90-dd3e7564701e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5e779250>]}
[0m15:19:52  Registered adapter: trino=1.8.0
[0m15:19:52  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m15:19:52  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:52  Partial parsing enabled, no changes found, skipping parsing
[0m15:19:52  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f488608-eff1-4b8c-af90-dd3e7564701e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c40c0d0>]}
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f488608-eff1-4b8c-af90-dd3e7564701e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c17bcd0>]}
[0m15:19:52  Found 6 models, 24 data tests, 15 sources, 564 macros
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f488608-eff1-4b8c-af90-dd3e7564701e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c295650>]}
[0m15:19:52  Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.1910181, "process_user_time": 2.916516, "process_kernel_time": 0.312844, "process_mem_max_rss": "115200", "process_in_blocks": "8768", "process_out_blocks": "1480"}
[0m15:19:52  Command `dbt ls` succeeded at 15:19:52.793262 after 1.19 seconds
[0m15:19:52  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c3f2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5c649cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee60b23f90>]}
[0m15:19:52  Flushing usage events
15:19:56  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092971bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092971bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092971b2d0>]}
15:19:56  Running with dbt=1.8.7
15:19:56  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'text', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --target dev --select dim_credit_card --debug --no-use-colors --fail-fast', 'send_anonymous_usage_stats': 'True'}
15:19:57  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0929512110>]}
15:19:57  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092b5097d0>]}
15:19:57  Registered adapter: trino=1.8.0
15:19:57  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
15:19:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:19:57  Partial parsing enabled, no changes found, skipping parsing
15:19:57  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
15:19:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09297b7590>]}
15:19:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09292f7510>]}
15:19:57  Found 6 models, 24 data tests, 15 sources, 564 macros
15:19:57  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0929511890>]}
15:19:57  
15:19:57  Acquiring new trino connection 'master'
15:19:57  Acquiring new trino connection 'list_iceberg'
15:19:57  Using trino connection "list_iceberg"
15:19:57  On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
15:19:57  Opening a new connection, currently in state init
15:19:58  SQL status: SUCCESS in 0.933 seconds
15:19:58  On list_iceberg: Close
15:19:58  Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_gold)
15:19:58  Using trino connection "list_iceberg_gold"
15:19:58  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
15:19:58  Opening a new connection, currently in state closed
15:20:00  SQL status: SUCCESS in 1.887 seconds
15:20:00  On list_iceberg_gold: ROLLBACK
15:20:00  On list_iceberg_gold: Close
15:20:00  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092923cb50>]}
15:20:00  On master: COMMIT
15:20:00  Concurrency: 4 threads (target='dev')
15:20:00  
15:20:00  Began running node model.dbt_trino_project.dim_credit_card
15:20:00  1 of 1 START sql table model gold.dim_credit_card .............................. [RUN]
15:20:00  Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.dim_credit_card)
15:20:00  Began compiling node model.dbt_trino_project.dim_credit_card
15:20:00  Writing injected SQL for node "model.dbt_trino_project.dim_credit_card"
15:20:00  Began executing node model.dbt_trino_project.dim_credit_card
15:20:01  Writing runtime sql for node "model.dbt_trino_project.dim_credit_card"
15:20:01  Using trino connection "model.dbt_trino_project.dim_credit_card"
15:20:01  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

  
    

    create table "iceberg"."gold"."dim_credit_card__dbt_tmp"
      
      
    as (
      -- models/marts/dim_credit_card.sql


with stg_salesorderheader as (
    select distinct
        creditcardid
    from "iceberg"."silver"."silver_sales_salesorderheader"
    where creditcardid is not null
),

stg_creditcard as (
    select
        creditcardid,
        cardtype
    from "iceberg"."silver"."silver_sales_creditcard"
)

select
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(stg_salesorderheader.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as credit_card_id_WID,
    cast(stg_salesorderheader.creditcardid as bigint) as INTEGRATION_ID,
    stg_creditcard.cardtype
from stg_salesorderheader
left join stg_creditcard
  on stg_salesorderheader.creditcardid = stg_creditcard.creditcardid
    )
15:20:01  Opening a new connection, currently in state closed
15:20:06  SQL status: SUCCESS in 5.429 seconds
15:20:06  Using trino connection "model.dbt_trino_project.dim_credit_card"
15:20:06  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */
alter table "iceberg"."gold"."dim_credit_card__dbt_tmp" rename to "iceberg"."gold"."dim_credit_card"
15:20:07  SQL status: SUCCESS in 0.685 seconds
15:20:07  Applying DROP to: "iceberg"."gold"."dim_credit_card__dbt_backup"
15:20:07  Using trino connection "model.dbt_trino_project.dim_credit_card"
15:20:07  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

    drop table if exists "iceberg"."gold"."dim_credit_card__dbt_backup"
15:20:07  SQL status: SUCCESS in 0.171 seconds
15:20:07  On model.dbt_trino_project.dim_credit_card: ROLLBACK
15:20:07  On model.dbt_trino_project.dim_credit_card: Close
15:20:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45b56a02-68cf-4198-9df8-115dfc4eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092845fd50>]}
15:20:07  1 of 1 OK created sql table model gold.dim_credit_card ......................... [SUCCESS in 6.59s]
15:20:07  Finished running node model.dbt_trino_project.dim_credit_card
15:20:07  On master: COMMIT
15:20:07  Connection 'master' was properly closed.
15:20:07  Connection 'model.dbt_trino_project.dim_credit_card' was properly closed.
15:20:07  
15:20:07  Finished running 1 table model in 0 hours 0 minutes and 9.54 seconds (9.54s).
15:20:07  Command end result
15:20:07  
15:20:07  Completed successfully
15:20:07  
15:20:07  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:20:07  Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.635259, "process_user_time": 4.360887, "process_kernel_time": 0.291395, "process_mem_max_rss": "123256", "process_in_blocks": "144", "process_out_blocks": "2840"}
15:20:07  Command `dbt run` succeeded at 15:20:07.533230 after 10.64 seconds
15:20:07  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092d8abf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092d8ab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f092d938850>]}
15:20:07  Flushing usage events
15:20:12  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8c4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8c4bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8c4b510>]}
15:20:12  Running with dbt=1.8.7
15:20:12  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir . --target dev --select dim_credit_card --debug --no-use-colors --fail-fast', 'static_parser': 'True', 'log_format': 'text', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
15:20:13  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8a3f590>]}
15:20:13  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10caa20f90>]}
15:20:13  Registered adapter: trino=1.8.0
15:20:13  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
15:20:13  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:20:13  Partial parsing enabled, no changes found, skipping parsing
15:20:13  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
15:20:13  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8cb5890>]}
15:20:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8410250>]}
15:20:13  Found 6 models, 24 data tests, 15 sources, 564 macros
15:20:13  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c83c9d50>]}
15:20:13  
15:20:13  Acquiring new trino connection 'master'
15:20:13  Acquiring new trino connection 'list_iceberg_gold'
15:20:13  Using trino connection "list_iceberg_gold"
15:20:13  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
15:20:13  Opening a new connection, currently in state init
15:20:14  SQL status: SUCCESS in 0.745 seconds
15:20:14  On list_iceberg_gold: ROLLBACK
15:20:14  On list_iceberg_gold: Close
15:20:14  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f1f8e8-1b85-44a3-93e7-be1503d70884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10c8539f90>]}
15:20:14  On master: COMMIT
15:20:14  Concurrency: 4 threads (target='dev')
15:20:14  
15:20:14  Began running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
15:20:14  Began running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
15:20:14  Began running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
15:20:14  Began running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
15:20:14  1 of 5 START test not_null_dim_credit_card_INTEGRATION_ID ...................... [RUN]
15:20:14  2 of 5 START test not_null_dim_credit_card_cardtype ............................ [RUN]
15:20:14  3 of 5 START test not_null_dim_credit_card_credit_card_id_WID .................. [RUN]
15:20:14  4 of 5 START test unique_dim_credit_card_INTEGRATION_ID ........................ [RUN]
15:20:14  Re-using an available connection from the pool (formerly list_iceberg_gold, now test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa)
15:20:14  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d'
15:20:14  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b'
15:20:14  Acquiring new trino connection 'test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d'
15:20:14  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
15:20:14  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
15:20:14  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
15:20:14  Began compiling node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
15:20:14  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
15:20:14  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
15:20:14  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
15:20:14  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
15:20:14  Began executing node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
15:20:14  Began executing node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
15:20:14  Began executing node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
15:20:14  Began executing node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
15:20:14  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
15:20:14  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
15:20:14  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
15:20:14  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
15:20:14  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
15:20:14  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
15:20:14  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
15:20:14  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cardtype
from "iceberg"."gold"."dim_credit_card"
where cardtype is null



      
    ) dbt_internal_test
15:20:14  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
15:20:14  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_id_WID
from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is null



      
    ) dbt_internal_test
15:20:14  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
15:20:14  Opening a new connection, currently in state init
15:20:14  Opening a new connection, currently in state closed
15:20:14  Opening a new connection, currently in state init
15:20:14  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
15:20:14  Opening a new connection, currently in state init
15:20:15  SQL status: SUCCESS in 0.650 seconds
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: ROLLBACK
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: Close
15:20:15  2 of 5 PASS not_null_dim_credit_card_cardtype .................................. [PASS in 0.76s]
15:20:15  Finished running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
15:20:15  Began running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
15:20:15  5 of 5 START test unique_dim_credit_card_credit_card_id_WID .................... [RUN]
15:20:15  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d, now test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b)
15:20:15  Began compiling node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
15:20:15  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
15:20:15  SQL status: SUCCESS in 0.673 seconds
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: ROLLBACK
15:20:15  Began executing node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: Close
15:20:15  SQL status: SUCCESS in 0.681 seconds
15:20:15  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
15:20:15  3 of 5 PASS not_null_dim_credit_card_credit_card_id_WID ........................ [PASS in 0.79s]
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: ROLLBACK
15:20:15  Finished running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
15:20:15  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: Close
15:20:15  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
15:20:15  1 of 5 PASS not_null_dim_credit_card_INTEGRATION_ID ............................ [PASS in 0.80s]
15:20:15  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_card_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is not null
group by credit_card_id_WID
having count(*) > 1



      
    ) dbt_internal_test
15:20:15  Finished running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
15:20:15  Opening a new connection, currently in state closed
15:20:15  SQL status: SUCCESS in 0.827 seconds
15:20:15  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: ROLLBACK
15:20:15  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: Close
15:20:15  4 of 5 PASS unique_dim_credit_card_INTEGRATION_ID .............................. [PASS in 0.94s]
15:20:15  Finished running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
15:20:16  SQL status: SUCCESS in 0.622 seconds
15:20:16  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: ROLLBACK
15:20:16  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: Close
15:20:16  5 of 5 PASS unique_dim_credit_card_credit_card_id_WID .......................... [PASS in 0.66s]
15:20:16  Finished running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
15:20:16  On master: COMMIT
15:20:16  Connection 'master' was properly closed.
15:20:16  Connection 'test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa' was properly closed.
15:20:16  Connection 'test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b' was properly closed.
15:20:16  Connection 'test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b' was properly closed.
15:20:16  Connection 'test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d' was properly closed.
15:20:16  
15:20:16  Finished running 5 data tests in 0 hours 0 minutes and 2.37 seconds (2.37s).
15:20:16  Command end result
15:20:16  
15:20:16  Completed successfully
15:20:16  
15:20:16  Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:20:16  Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5280602, "process_user_time": 5.525684, "process_kernel_time": 0.332144, "process_mem_max_rss": "126628", "process_in_blocks": "208", "process_out_blocks": "2928"}
15:20:16  Command `dbt test` succeeded at 15:20:16.214126 after 3.53 seconds
15:20:16  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ccdcb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ccdcb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10cce54590>]}
15:20:16  Flushing usage events
[0m10:33:59  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841b0d3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841b0d2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841b0d0dd0>]}
[0m10:33:59  Running with dbt=1.8.7
[0m10:33:59  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'log_format': 'text', 'invocation_command': 'dbt ls --profiles-dir . --target dev --quiet --resource-type model --output name --select tag:gold', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:00  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a05deae9-ff5f-4d9d-9b32-e3c830056825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841aecb7d0>]}
[0m10:34:00  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a05deae9-ff5f-4d9d-9b32-e3c830056825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841ce45e90>]}
[0m10:34:00  Registered adapter: trino=1.8.0
[0m10:34:00  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m10:34:00  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:00  Partial parsing enabled, no changes found, skipping parsing
[0m10:34:00  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m10:34:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a05deae9-ff5f-4d9d-9b32-e3c830056825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841b131890>]}
[0m10:34:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a05deae9-ff5f-4d9d-9b32-e3c830056825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841a8a11d0>]}
[0m10:34:01  Found 6 models, 24 data tests, 15 sources, 564 macros
[0m10:34:01  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05deae9-ff5f-4d9d-9b32-e3c830056825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841aca1dd0>]}
[0m10:34:01  Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4263265, "process_user_time": 2.913074, "process_kernel_time": 0.4474, "process_mem_max_rss": "115468", "process_in_blocks": "25864", "process_out_blocks": "1480"}
[0m10:34:01  Command `dbt ls` succeeded at 10:34:01.311615 after 1.43 seconds
[0m10:34:01  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841f1ff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841f290a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f841f290b10>]}
[0m10:34:01  Flushing usage events
10:34:05  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b645dca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b645dd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b645dfd50>]}
10:34:05  Running with dbt=1.8.7
10:34:05  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'text', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev --select tag:gold --debug --no-use-colors --fail-fast', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
10:34:05  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b643cf650>]}
10:34:05  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b66340a90>]}
10:34:05  Registered adapter: trino=1.8.0
10:34:06  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
10:34:06  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:34:06  Partial parsing enabled, no changes found, skipping parsing
10:34:06  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
10:34:06  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b63f53310>]}
10:34:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6404c310>]}
10:34:06  Found 6 models, 24 data tests, 15 sources, 564 macros
10:34:06  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64703310>]}
10:34:06  
10:34:06  Acquiring new trino connection 'master'
10:34:06  Acquiring new trino connection 'list_iceberg'
10:34:06  Using trino connection "list_iceberg"
10:34:06  On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
10:34:06  Opening a new connection, currently in state init
10:34:07  SQL status: SUCCESS in 0.599 seconds
10:34:07  On list_iceberg: Close
10:34:07  Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_gold)
10:34:07  Using trino connection "list_iceberg_gold"
10:34:07  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
10:34:07  Opening a new connection, currently in state closed
10:34:07  SQL status: SUCCESS in 0.539 seconds
10:34:07  On list_iceberg_gold: ROLLBACK
10:34:07  On list_iceberg_gold: Close
10:34:07  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64703310>]}
10:34:07  On master: COMMIT
10:34:07  Concurrency: 4 threads (target='dev')
10:34:07  
10:34:07  Began running node model.dbt_trino_project.dim_address
10:34:07  Began running node model.dbt_trino_project.dim_credit_card
10:34:07  Began running node model.dbt_trino_project.dim_customer
10:34:07  1 of 6 START sql table model gold.dim_address .................................. [RUN]
10:34:07  Began running node model.dbt_trino_project.dim_order_status
10:34:07  2 of 6 START sql table model gold.dim_credit_card .............................. [RUN]
10:34:07  3 of 6 START sql table model gold.dim_customer ................................. [RUN]
10:34:07  Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.dim_address)
10:34:07  4 of 6 START sql table model gold.dim_order_status ............................. [RUN]
10:34:07  Acquiring new trino connection 'model.dbt_trino_project.dim_credit_card'
10:34:07  Acquiring new trino connection 'model.dbt_trino_project.dim_customer'
10:34:07  Began compiling node model.dbt_trino_project.dim_address
10:34:07  Acquiring new trino connection 'model.dbt_trino_project.dim_order_status'
10:34:07  Began compiling node model.dbt_trino_project.dim_credit_card
10:34:07  Began compiling node model.dbt_trino_project.dim_customer
10:34:07  Began compiling node model.dbt_trino_project.dim_order_status
10:34:07  Writing injected SQL for node "model.dbt_trino_project.dim_address"
10:34:07  Writing injected SQL for node "model.dbt_trino_project.dim_customer"
10:34:07  Writing injected SQL for node "model.dbt_trino_project.dim_credit_card"
10:34:07  Writing injected SQL for node "model.dbt_trino_project.dim_order_status"
10:34:07  Began executing node model.dbt_trino_project.dim_address
10:34:07  Began executing node model.dbt_trino_project.dim_customer
10:34:07  Began executing node model.dbt_trino_project.dim_credit_card
10:34:07  Began executing node model.dbt_trino_project.dim_order_status
10:34:08  Writing runtime sql for node "model.dbt_trino_project.dim_address"
10:34:08  Writing runtime sql for node "model.dbt_trino_project.dim_credit_card"
10:34:08  Writing runtime sql for node "model.dbt_trino_project.dim_order_status"
10:34:08  Writing runtime sql for node "model.dbt_trino_project.dim_customer"
10:34:08  Using trino connection "model.dbt_trino_project.dim_address"
10:34:08  Using trino connection "model.dbt_trino_project.dim_credit_card"
10:34:08  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

  
    

    create table "iceberg"."gold"."dim_address__dbt_tmp"
      
      
    as (
      

with stg_address as (
  select * from "iceberg"."silver"."silver_person_address"
),
stg_stateprovince as (
  select * from "iceberg"."silver"."silver_person_stateprovince"
),
stg_countryregion as (
  select * from "iceberg"."silver"."silver_person_countryregion"
)

select
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(a.addressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as address_id_WID,
  a.addressid as INTEGRATION_ID,

  -- Thuộc tính mô tả
  a.addressline1,
  a.addressline2,
  a.city,
  a.postalcode,

  -- State/Province
  cast(a.stateprovinceid as bigint) as stateprovinceid,
  sp.stateprovincecode,
  sp.name as stateprovince_name,

  -- Country/Region
  sp.countryregioncode,
  cr.name as country_name,

  -- Phụ trợ
  a.spatiallocation,
  a.rowguid,
  a.modifieddate

from stg_address a
left join stg_stateprovince sp
  on cast(a.stateprovinceid as bigint) = sp.stateprovinceid
left join stg_countryregion cr
  on sp.countryregioncode = cr.countryregioncode
    )
10:34:08  Using trino connection "model.dbt_trino_project.dim_order_status"
10:34:08  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

  
    

    create table "iceberg"."gold"."dim_credit_card__dbt_tmp"
      
      
    as (
      -- models/marts/dim_credit_card.sql


with stg_salesorderheader as (
    select distinct
        creditcardid
    from "iceberg"."silver"."silver_sales_salesorderheader"
    where creditcardid is not null
),

stg_creditcard as (
    select
        creditcardid,
        cardtype
    from "iceberg"."silver"."silver_sales_creditcard"
)

select
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(stg_salesorderheader.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as credit_card_id_WID,
    cast(stg_salesorderheader.creditcardid as bigint) as INTEGRATION_ID,
    stg_creditcard.cardtype
from stg_salesorderheader
left join stg_creditcard
  on stg_salesorderheader.creditcardid = stg_creditcard.creditcardid
    )
10:34:08  Using trino connection "model.dbt_trino_project.dim_customer"
10:34:08  Opening a new connection, currently in state closed
10:34:08  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */

  
    

    create table "iceberg"."gold"."dim_order_status__dbt_tmp"
      
      
    as (
      

-- Lấy các trạng thái đơn hàng duy nhất từ SalesOrderHeader
with src as (
  select distinct status as order_status
  from "iceberg"."silver"."silver_sales_salesorderheader"
)

select
  -- Surrogate key ổn định theo status
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(order_status as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_status_id_WID,

  -- Business key
  order_status as INTEGRATION_ID,

  -- Tên hiển thị (AdventureWorks conventions)
  case order_status
    when 1 then 'In Process'
    when 2 then 'Approved'
    when 3 then 'Backordered'
    when 4 then 'Rejected'
    when 5 then 'Shipped'
    when 6 then 'Cancelled'
    else 'Unknown'
  end as order_status_name

from src
    )
10:34:08  Opening a new connection, currently in state init
10:34:08  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */

  
    

    create table "iceberg"."gold"."dim_customer__dbt_tmp"
      
      
    as (
      -- models/marts/dim_customer.sql


with stg_customer as (
  select
      customerid,
      try_cast(personid as bigint) as personid,
      try_cast(storeid  as bigint) as storeid
  from "iceberg"."silver"."silver_sales_customer"
),

stg_person as (
  select
      businessentityid,
      -- build fullname, gọn và sạch khoảng trắng
      trim(
        regexp_replace(
          concat(
            coalesce(firstname, ''),
            ' ',
            coalesce(middlename, ''),
            ' ',
            coalesce(lastname, '')
          ),
          '\\s+',
          ' '
        )
      ) as fullname
  from "iceberg"."silver"."silver_person_person"
),

stg_store as (
  select
      businessentityid as storebusinessentityid,
      name as storename
  from "iceberg"."silver"."silver_sales_store"
)

select
  -- SKey ổn định theo customerid
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(stg_customer.customerid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as customer_id_WID,

  -- Business key gốc
  cast(stg_customer.customerid as bigint) as INTEGRATION_ID,

  -- Person
  stg_person.businessentityid,
  stg_person.fullname,

  -- Store
  stg_store.storebusinessentityid,
  stg_store.storename

from stg_customer
left join stg_person
  on stg_customer.personid = stg_person.businessentityid
left join stg_store
  on stg_customer.storeid = stg_store.storebusinessentityid
    )
10:34:08  Opening a new connection, currently in state init
10:34:08  Opening a new connection, currently in state init
10:34:09  SQL status: SUCCESS in 1.547 seconds
10:34:09  Using trino connection "model.dbt_trino_project.dim_order_status"
10:34:09  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */
alter table "iceberg"."gold"."dim_order_status" rename to "iceberg"."gold"."dim_order_status__dbt_backup"
10:34:10  SQL status: SUCCESS in 0.334 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_order_status"
10:34:10  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */
alter table "iceberg"."gold"."dim_order_status__dbt_tmp" rename to "iceberg"."gold"."dim_order_status"
10:34:10  SQL status: SUCCESS in 1.936 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_credit_card"
10:34:10  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */
alter table "iceberg"."gold"."dim_credit_card" rename to "iceberg"."gold"."dim_credit_card__dbt_backup"
10:34:10  SQL status: SUCCESS in 0.262 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_credit_card"
10:34:10  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */
alter table "iceberg"."gold"."dim_credit_card__dbt_tmp" rename to "iceberg"."gold"."dim_credit_card"
10:34:10  SQL status: SUCCESS in 0.323 seconds
10:34:10  Applying DROP to: "iceberg"."gold"."dim_order_status__dbt_backup"
10:34:10  Using trino connection "model.dbt_trino_project.dim_order_status"
10:34:10  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */

    drop table if exists "iceberg"."gold"."dim_order_status__dbt_backup"
10:34:10  SQL status: SUCCESS in 2.343 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_customer"
10:34:10  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */
alter table "iceberg"."gold"."dim_customer" rename to "iceberg"."gold"."dim_customer__dbt_backup"
10:34:10  SQL status: SUCCESS in 2.462 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_address"
10:34:10  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */
alter table "iceberg"."gold"."dim_address" rename to "iceberg"."gold"."dim_address__dbt_backup"
10:34:10  SQL status: SUCCESS in 0.287 seconds
10:34:10  Applying DROP to: "iceberg"."gold"."dim_credit_card__dbt_backup"
10:34:10  Using trino connection "model.dbt_trino_project.dim_credit_card"
10:34:10  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

    drop table if exists "iceberg"."gold"."dim_credit_card__dbt_backup"
10:34:10  SQL status: SUCCESS in 0.340 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_customer"
10:34:10  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */
alter table "iceberg"."gold"."dim_customer__dbt_tmp" rename to "iceberg"."gold"."dim_customer"
10:34:10  SQL status: SUCCESS in 0.462 seconds
10:34:10  On model.dbt_trino_project.dim_order_status: ROLLBACK
10:34:10  On model.dbt_trino_project.dim_order_status: Close
10:34:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b633f31d0>]}
10:34:10  4 of 6 OK created sql table model gold.dim_order_status ........................ [SUCCESS in 3.13s]
10:34:10  Finished running node model.dbt_trino_project.dim_order_status
10:34:10  Began running node model.dbt_trino_project.dim_product
10:34:10  5 of 6 START sql table model gold.dim_product .................................. [RUN]
10:34:10  Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_order_status, now model.dbt_trino_project.dim_product)
10:34:10  Began compiling node model.dbt_trino_project.dim_product
10:34:10  Writing injected SQL for node "model.dbt_trino_project.dim_product"
10:34:10  Began executing node model.dbt_trino_project.dim_product
10:34:10  Writing runtime sql for node "model.dbt_trino_project.dim_product"
10:34:10  Using trino connection "model.dbt_trino_project.dim_product"
10:34:10  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */

  
    

    create table "iceberg"."gold"."dim_product__dbt_tmp"
      
      
    as (
      

with stg_product as (
  select * from "iceberg"."silver"."silver_production_product"
),
stg_product_subcateg as (
  select * from "iceberg"."silver"."silver_production_productsubcategory"
),
stg_product_category as (
  select * from "iceberg"."silver"."silver_production_productcategory"
)

select
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.productid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as product_id_WID,
  p.productid as INTEGRATION_ID,
  p.name as product_name,
  p.productnumber,
  p.makeflag,
  p.finishedgoodsflag,
  p.color,
  p.productline,
  p.class,
  p.style,
  p.size,
  p.sizeunitmeasurecode,
  p.weightunitmeasurecode,
  p.weight,
  p.safetystocklevel,
  p.reorderpoint,
  p.standardcost,
  p.listprice,
  p.daystomanufacture,
  p.sellstartdate,
  p.sellenddate,
  p.discontinueddate,
  cast(p.productsubcategoryid as bigint) as productsubcategoryid,
  psc.name as product_subcategory_name,
  pc.productcategoryid,
  pc.name as product_category_name
from stg_product p
left join stg_product_subcateg psc
  on cast(p.productsubcategoryid as bigint) = psc.productsubcategoryid
left join stg_product_category pc
  on psc.productcategoryid = pc.productcategoryid
    )
10:34:10  Opening a new connection, currently in state closed
10:34:10  SQL status: SUCCESS in 0.355 seconds
10:34:10  Using trino connection "model.dbt_trino_project.dim_address"
10:34:10  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */
alter table "iceberg"."gold"."dim_address__dbt_tmp" rename to "iceberg"."gold"."dim_address"
10:34:10  SQL status: SUCCESS in 0.349 seconds
10:34:10  On model.dbt_trino_project.dim_credit_card: ROLLBACK
10:34:10  On model.dbt_trino_project.dim_credit_card: Close
10:34:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b64634890>]}
10:34:11  2 of 6 OK created sql table model gold.dim_credit_card ......................... [SUCCESS in 3.24s]
10:34:11  Finished running node model.dbt_trino_project.dim_credit_card
10:34:11  Began running node model.dbt_trino_project.fact_sales
10:34:11  6 of 6 START sql table model gold.fact_sales ................................... [RUN]
10:34:11  Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_credit_card, now model.dbt_trino_project.fact_sales)
10:34:11  Began compiling node model.dbt_trino_project.fact_sales
10:34:11  Writing injected SQL for node "model.dbt_trino_project.fact_sales"
10:34:11  Began executing node model.dbt_trino_project.fact_sales
10:34:11  Writing runtime sql for node "model.dbt_trino_project.fact_sales"
10:34:11  Using trino connection "model.dbt_trino_project.fact_sales"
10:34:11  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

  
    

    create table "iceberg"."gold"."fact_sales__dbt_tmp"
      
      
    as (
      -- models/marts/fact_sales.sql


with stg_salesorderheader as (
    select
        salesorderid,
        customerid,
        creditcardid,
        shiptoaddressid,
        cast(status as bigint)       as order_status,
        cast(orderdate as date)      as orderdate,
        totaldue
    from "iceberg"."silver"."silver_sales_salesorderheader"
),

stg_salesorderdetail as (
    select
        salesorderid,
        salesorderdetailid,
        productid,
        orderqty,
        unitprice,
        (unitprice * orderqty) as revenue
    from "iceberg"."silver"."silver_sales_salesorderdetail"
)

select
    -- Grain: 1 row / (salesorderid, salesorderdetailid)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.salesorderid as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(d.salesorderdetailid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as sales_id_WID,

    -- FKs sang dims (hash từ natural keys)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.productid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as product_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.customerid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))       as customer_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as credit_card_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.shiptoaddressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))  as ship_address_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.order_status as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as order_status_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.orderdate as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as order_date_id_WID,

    -- Natural keys / trace
    d.salesorderid,
    d.salesorderdetailid,
    d.productid,
    h.customerid,
    h.creditcardid,
    h.shiptoaddressid,
    h.order_status,
    h.orderdate,

    -- Measures
    d.unitprice,
    d.orderqty,
    d.revenue,
    h.totaldue

from stg_salesorderdetail d
join stg_salesorderheader h
  on d.salesorderid = h.salesorderid
    )
10:34:11  Opening a new connection, currently in state closed
10:34:11  SQL status: SUCCESS in 0.324 seconds
10:34:11  Applying DROP to: "iceberg"."gold"."dim_customer__dbt_backup"
10:34:11  Using trino connection "model.dbt_trino_project.dim_customer"
10:34:11  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */

    drop table if exists "iceberg"."gold"."dim_customer__dbt_backup"
10:34:11  SQL status: SUCCESS in 0.383 seconds
10:34:11  Applying DROP to: "iceberg"."gold"."dim_address__dbt_backup"
10:34:11  Using trino connection "model.dbt_trino_project.dim_address"
10:34:11  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

    drop table if exists "iceberg"."gold"."dim_address__dbt_backup"
10:34:11  SQL status: SUCCESS in 0.367 seconds
10:34:11  On model.dbt_trino_project.dim_customer: ROLLBACK
10:34:11  On model.dbt_trino_project.dim_customer: Close
10:34:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6428a7d0>]}
10:34:11  3 of 6 OK created sql table model gold.dim_customer ............................ [SUCCESS in 3.79s]
10:34:11  Finished running node model.dbt_trino_project.dim_customer
10:34:11  SQL status: SUCCESS in 0.351 seconds
10:34:11  On model.dbt_trino_project.dim_address: ROLLBACK
10:34:11  On model.dbt_trino_project.dim_address: Close
10:34:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b63257f50>]}
10:34:11  1 of 6 OK created sql table model gold.dim_address ............................. [SUCCESS in 3.97s]
10:34:11  Finished running node model.dbt_trino_project.dim_address
10:34:12  SQL status: SUCCESS in 1.170 seconds
10:34:12  Using trino connection "model.dbt_trino_project.dim_product"
10:34:12  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */
alter table "iceberg"."gold"."dim_product" rename to "iceberg"."gold"."dim_product__dbt_backup"
10:34:12  SQL status: SUCCESS in 0.541 seconds
10:34:12  Using trino connection "model.dbt_trino_project.dim_product"
10:34:12  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */
alter table "iceberg"."gold"."dim_product__dbt_tmp" rename to "iceberg"."gold"."dim_product"
10:34:12  SQL status: SUCCESS in 0.175 seconds
10:34:12  Applying DROP to: "iceberg"."gold"."dim_product__dbt_backup"
10:34:12  Using trino connection "model.dbt_trino_project.dim_product"
10:34:12  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */

    drop table if exists "iceberg"."gold"."dim_product__dbt_backup"
10:34:13  SQL status: SUCCESS in 0.260 seconds
10:34:13  On model.dbt_trino_project.dim_product: ROLLBACK
10:34:13  On model.dbt_trino_project.dim_product: Close
10:34:13  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b6312a350>]}
10:34:13  5 of 6 OK created sql table model gold.dim_product ............................. [SUCCESS in 2.21s]
10:34:13  Finished running node model.dbt_trino_project.dim_product
10:34:21  SQL status: SUCCESS in 10.420 seconds
10:34:21  Using trino connection "model.dbt_trino_project.fact_sales"
10:34:21  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales" rename to "iceberg"."gold"."fact_sales__dbt_backup"
10:34:21  SQL status: SUCCESS in 0.503 seconds
10:34:21  Using trino connection "model.dbt_trino_project.fact_sales"
10:34:22  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales__dbt_tmp" rename to "iceberg"."gold"."fact_sales"
10:34:22  SQL status: SUCCESS in 0.155 seconds
10:34:22  Applying DROP to: "iceberg"."gold"."fact_sales__dbt_backup"
10:34:22  Using trino connection "model.dbt_trino_project.fact_sales"
10:34:22  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

    drop table if exists "iceberg"."gold"."fact_sales__dbt_backup"
10:34:22  SQL status: SUCCESS in 0.252 seconds
10:34:22  On model.dbt_trino_project.fact_sales: ROLLBACK
10:34:22  On model.dbt_trino_project.fact_sales: Close
10:34:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ad4b2d-44b3-4713-8041-b7eae12385a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b60073090>]}
10:34:22  6 of 6 OK created sql table model gold.fact_sales .............................. [SUCCESS in 11.41s]
10:34:22  Finished running node model.dbt_trino_project.fact_sales
10:34:22  On master: COMMIT
10:34:22  Connection 'master' was properly closed.
10:34:22  Connection 'model.dbt_trino_project.dim_address' was properly closed.
10:34:22  Connection 'model.dbt_trino_project.fact_sales' was properly closed.
10:34:22  Connection 'model.dbt_trino_project.dim_customer' was properly closed.
10:34:22  Connection 'model.dbt_trino_project.dim_product' was properly closed.
10:34:22  
10:34:22  Finished running 6 table models in 0 hours 0 minutes and 15.98 seconds (15.98s).
10:34:22  Command end result
10:34:22  
10:34:22  Completed successfully
10:34:22  
10:34:22  Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
10:34:22  Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.196413, "process_user_time": 10.795307, "process_kernel_time": 0.540265, "process_mem_max_rss": "126956", "process_in_blocks": "3144", "process_out_blocks": "3024"}
10:34:22  Command `dbt run` succeeded at 10:34:22.517697 after 17.20 seconds
10:34:22  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b686fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b686fb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b68784a10>]}
10:34:22  Flushing usage events
10:34:29  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753f731d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753f72f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753f71290>]}
10:34:29  Running with dbt=1.8.7
10:34:29  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir . --target dev --select tag:gold --debug --no-use-colors --fail-fast', 'log_format': 'text', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
10:34:29  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753d5f610>]}
10:34:29  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0755a90810>]}
10:34:29  Registered adapter: trino=1.8.0
10:34:29  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
10:34:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:34:30  Partial parsing enabled, no changes found, skipping parsing
10:34:30  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
10:34:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07538e67d0>]}
10:34:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753b9fb10>]}
10:34:30  Found 6 models, 24 data tests, 15 sources, 564 macros
10:34:30  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753b34e50>]}
10:34:30  
10:34:30  Acquiring new trino connection 'master'
10:34:30  Acquiring new trino connection 'list_iceberg_gold'
10:34:30  Using trino connection "list_iceberg_gold"
10:34:30  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
10:34:30  Opening a new connection, currently in state init
10:34:31  SQL status: SUCCESS in 0.610 seconds
10:34:31  On list_iceberg_gold: ROLLBACK
10:34:31  On list_iceberg_gold: Close
10:34:31  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39762866-c7d1-45b3-b1e8-54ce46878e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0753b5aa90>]}
10:34:31  On master: COMMIT
10:34:31  Concurrency: 4 threads (target='dev')
10:34:31  
10:34:31  Began running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
10:34:31  Began running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
10:34:31  Began running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
10:34:31  Began running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
10:34:31  1 of 24 START test not_null_dim_address_INTEGRATION_ID ......................... [RUN]
10:34:31  2 of 24 START test not_null_dim_address_address_id_WID ......................... [RUN]
10:34:31  3 of 24 START test not_null_dim_address_addressline1 ........................... [RUN]
10:34:31  4 of 24 START test not_null_dim_credit_card_INTEGRATION_ID ..................... [RUN]
10:34:31  Re-using an available connection from the pool (formerly list_iceberg_gold, now test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563)
10:34:31  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f'
10:34:31  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8'
10:34:31  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa'
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
10:34:31  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addressline1
from "iceberg"."gold"."dim_address"
where addressline1 is null



      
    ) dbt_internal_test
10:34:31  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id_WID
from "iceberg"."gold"."dim_address"
where address_id_WID is null



      
    ) dbt_internal_test
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
10:34:31  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_address"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
10:34:31  Opening a new connection, currently in state init
10:34:31  Opening a new connection, currently in state init
10:34:31  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
10:34:31  Opening a new connection, currently in state closed
10:34:31  Opening a new connection, currently in state init
10:34:31  SQL status: SUCCESS in 0.502 seconds
10:34:31  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: ROLLBACK
10:34:31  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: Close
10:34:31  1 of 24 PASS not_null_dim_address_INTEGRATION_ID ............................... [PASS in 0.63s]
10:34:31  Finished running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
10:34:31  Began running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
10:34:31  SQL status: SUCCESS in 0.530 seconds
10:34:31  5 of 24 START test not_null_dim_credit_card_cardtype ........................... [RUN]
10:34:31  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: ROLLBACK
10:34:31  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563, now test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d)
10:34:31  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: Close
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
10:34:31  2 of 24 PASS not_null_dim_address_address_id_WID ............................... [PASS in 0.65s]
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
10:34:31  Finished running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
10:34:31  Began running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
10:34:31  6 of 24 START test not_null_dim_credit_card_credit_card_id_WID ................. [RUN]
10:34:31  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f, now test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b)
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
10:34:31  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cardtype
from "iceberg"."gold"."dim_credit_card"
where cardtype is null



      
    ) dbt_internal_test
10:34:31  Opening a new connection, currently in state closed
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
10:34:31  SQL status: SUCCESS in 0.586 seconds
10:34:31  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_id_WID
from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is null



      
    ) dbt_internal_test
10:34:31  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: ROLLBACK
10:34:31  Opening a new connection, currently in state closed
10:34:31  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: Close
10:34:31  SQL status: SUCCESS in 0.600 seconds
10:34:31  4 of 24 PASS not_null_dim_credit_card_INTEGRATION_ID ........................... [PASS in 0.70s]
10:34:31  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: ROLLBACK
10:34:31  Finished running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
10:34:31  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: Close
10:34:31  Began running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
10:34:31  7 of 24 START test not_null_dim_customer_INTEGRATION_ID ........................ [RUN]
10:34:31  3 of 24 PASS not_null_dim_address_addressline1 ................................. [PASS in 0.71s]
10:34:31  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa, now test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a)
10:34:31  Finished running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
10:34:31  Began running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
10:34:31  8 of 24 START test not_null_dim_customer_customer_id_WID ....................... [RUN]
10:34:31  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8, now test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800)
10:34:31  Began compiling node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
10:34:31  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
10:34:31  Began executing node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
10:34:31  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
10:34:31  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_customer"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
10:34:31  Opening a new connection, currently in state closed
10:34:31  Using trino connection "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
10:34:31  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id_WID
from "iceberg"."gold"."dim_customer"
where customer_id_WID is null



      
    ) dbt_internal_test
10:34:31  Opening a new connection, currently in state closed
10:34:32  SQL status: SUCCESS in 0.448 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: ROLLBACK
10:34:32  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: Close
10:34:32  6 of 24 PASS not_null_dim_credit_card_credit_card_id_WID ....................... [PASS in 0.49s]
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
10:34:32  Began running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
10:34:32  9 of 24 START test not_null_dim_order_status_INTEGRATION_ID .................... [RUN]
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b, now test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0)
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
10:34:32  SQL status: SUCCESS in 0.479 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: ROLLBACK
10:34:32  SQL status: SUCCESS in 0.418 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: Close
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
10:34:32  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: ROLLBACK
10:34:32  5 of 24 PASS not_null_dim_credit_card_cardtype ................................. [PASS in 0.54s]
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
10:34:32  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: Close
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
10:34:32  7 of 24 PASS not_null_dim_customer_INTEGRATION_ID .............................. [PASS in 0.47s]
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
10:34:32  Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_order_status"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
10:34:32  10 of 24 START test not_null_dim_order_status_order_status_id_WID .............. [RUN]
10:34:32  Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
10:34:32  SQL status: SUCCESS in 0.437 seconds
10:34:32  Opening a new connection, currently in state closed
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d, now test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308)
10:34:32  11 of 24 START test not_null_dim_order_status_order_status_name ................ [RUN]
10:34:32  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: ROLLBACK
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a, now test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1)
10:34:32  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: Close
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
10:34:32  8 of 24 PASS not_null_dim_customer_customer_id_WID ............................. [PASS in 0.49s]
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
10:34:32  Began running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
10:34:32  12 of 24 START test not_null_dim_product_INTEGRATION_ID ........................ [RUN]
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800, now test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d)
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status_id_WID
from "iceberg"."gold"."dim_order_status"
where order_status_id_WID is null



      
    ) dbt_internal_test
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
10:34:32  Opening a new connection, currently in state closed
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status_name
from "iceberg"."gold"."dim_order_status"
where order_status_name is null



      
    ) dbt_internal_test
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
10:34:32  Opening a new connection, currently in state closed
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
10:34:32  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_product"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
10:34:32  Opening a new connection, currently in state closed
10:34:32  SQL status: SUCCESS in 0.456 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: ROLLBACK
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: Close
10:34:32  9 of 24 PASS not_null_dim_order_status_INTEGRATION_ID .......................... [PASS in 0.50s]
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
10:34:32  Began running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
10:34:32  13 of 24 START test not_null_dim_product_product_id_WID ........................ [RUN]
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0, now test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656)
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
10:34:32  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id_WID
from "iceberg"."gold"."dim_product"
where product_id_WID is null



      
    ) dbt_internal_test
10:34:32  Opening a new connection, currently in state closed
10:34:32  SQL status: SUCCESS in 0.434 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: ROLLBACK
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: Close
10:34:32  10 of 24 PASS not_null_dim_order_status_order_status_id_WID .................... [PASS in 0.50s]
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
10:34:32  Began running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
10:34:32  14 of 24 START test not_null_dim_product_product_name .......................... [RUN]
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308, now test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5)
10:34:32  Began compiling node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
10:34:32  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
10:34:32  Began executing node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
10:34:32  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
10:34:32  Using trino connection "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
10:34:32  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "iceberg"."gold"."dim_product"
where product_name is null



      
    ) dbt_internal_test
10:34:32  Opening a new connection, currently in state closed
10:34:32  SQL status: SUCCESS in 0.479 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: ROLLBACK
10:34:32  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: Close
10:34:32  11 of 24 PASS not_null_dim_order_status_order_status_name ...................... [PASS in 0.55s]
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
10:34:32  Began running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
10:34:32  15 of 24 START test unique_dim_address_INTEGRATION_ID .......................... [RUN]
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1, now test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172)
10:34:32  Began compiling node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
10:34:32  Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
10:34:32  Began executing node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
10:34:32  Writing runtime sql for node "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
10:34:32  SQL status: SUCCESS in 0.491 seconds
10:34:32  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: ROLLBACK
10:34:32  Using trino connection "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
10:34:32  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: Close
10:34:32  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_address"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
10:34:32  12 of 24 PASS not_null_dim_product_INTEGRATION_ID .............................. [PASS in 0.54s]
10:34:32  Opening a new connection, currently in state closed
10:34:32  Finished running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
10:34:32  Began running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
10:34:32  16 of 24 START test unique_dim_address_address_id_WID .......................... [RUN]
10:34:32  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d, now test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978)
10:34:32  Began compiling node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
10:34:32  Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
10:34:32  Began executing node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
10:34:32  Writing runtime sql for node "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
10:34:32  Using trino connection "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
10:34:32  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    address_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_address"
where address_id_WID is not null
group by address_id_WID
having count(*) > 1



      
    ) dbt_internal_test
10:34:32  Opening a new connection, currently in state closed
10:34:33  SQL status: SUCCESS in 0.445 seconds
10:34:33  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: ROLLBACK
10:34:33  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: Close
10:34:33  13 of 24 PASS not_null_dim_product_product_id_WID .............................. [PASS in 0.48s]
10:34:33  Finished running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
10:34:33  Began running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
10:34:33  SQL status: SUCCESS in 0.428 seconds
10:34:33  17 of 24 START test unique_dim_credit_card_INTEGRATION_ID ...................... [RUN]
10:34:33  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: ROLLBACK
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656, now test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d)
10:34:33  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: Close
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
10:34:33  14 of 24 PASS not_null_dim_product_product_name ................................ [PASS in 0.46s]
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
10:34:33  Finished running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
10:34:33  Began running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
10:34:33  Began executing node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
10:34:33  18 of 24 START test unique_dim_credit_card_credit_card_id_WID .................. [RUN]
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5, now test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b)
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:33  Began executing node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_card_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is not null
group by credit_card_id_WID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:33  SQL status: SUCCESS in 0.547 seconds
10:34:33  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: ROLLBACK
10:34:33  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: Close
10:34:33  15 of 24 PASS unique_dim_address_INTEGRATION_ID ................................ [PASS in 0.59s]
10:34:33  Finished running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
10:34:33  Began running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
10:34:33  19 of 24 START test unique_dim_customer_INTEGRATION_ID ......................... [RUN]
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172, now test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165)
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
10:34:33  Began executing node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
10:34:33  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_customer"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:33  SQL status: SUCCESS in 0.555 seconds
10:34:33  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: ROLLBACK
10:34:33  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: Close
10:34:33  16 of 24 PASS unique_dim_address_address_id_WID ................................ [PASS in 0.59s]
10:34:33  Finished running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
10:34:33  Began running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
10:34:33  20 of 24 START test unique_dim_customer_customer_id_WID ........................ [RUN]
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978, now test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987)
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
10:34:33  Began executing node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
10:34:33  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_customer"
where customer_id_WID is not null
group by customer_id_WID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:33  SQL status: SUCCESS in 0.474 seconds
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: ROLLBACK
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: Close
10:34:33  17 of 24 PASS unique_dim_credit_card_INTEGRATION_ID ............................ [PASS in 0.53s]
10:34:33  Finished running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
10:34:33  Began running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
10:34:33  21 of 24 START test unique_dim_order_status_INTEGRATION_ID ..................... [RUN]
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d, now test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477)
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
10:34:33  Began executing node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
10:34:33  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_order_status"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:33  SQL status: SUCCESS in 0.518 seconds
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: ROLLBACK
10:34:33  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: Close
10:34:33  18 of 24 PASS unique_dim_credit_card_credit_card_id_WID ........................ [PASS in 0.56s]
10:34:33  Finished running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
10:34:33  Began running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
10:34:33  22 of 24 START test unique_dim_order_status_order_status_id_WID ................ [RUN]
10:34:33  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b, now test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882)
10:34:33  Began compiling node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
10:34:33  Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
10:34:33  Began executing node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
10:34:33  Writing runtime sql for node "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
10:34:33  Using trino connection "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
10:34:33  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_status_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_order_status"
where order_status_id_WID is not null
group by order_status_id_WID
having count(*) > 1



      
    ) dbt_internal_test
10:34:33  Opening a new connection, currently in state closed
10:34:34  SQL status: SUCCESS in 0.522 seconds
10:34:34  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: ROLLBACK
10:34:34  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: Close
10:34:34  21 of 24 PASS unique_dim_order_status_INTEGRATION_ID ........................... [PASS in 0.55s]
10:34:34  Finished running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
10:34:34  Began running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
10:34:34  23 of 24 START test unique_dim_product_INTEGRATION_ID .......................... [RUN]
10:34:34  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477, now test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5)
10:34:34  Began compiling node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
10:34:34  Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
10:34:34  Began executing node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
10:34:34  Writing runtime sql for node "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
10:34:34  Using trino connection "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
10:34:34  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_product"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
10:34:34  Opening a new connection, currently in state closed
10:34:34  SQL status: SUCCESS in 0.734 seconds
10:34:34  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: ROLLBACK
10:34:34  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: Close
10:34:34  22 of 24 PASS unique_dim_order_status_order_status_id_WID ...................... [PASS in 0.77s]
10:34:34  Finished running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
10:34:34  Began running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
10:34:34  24 of 24 START test unique_dim_product_product_id_WID .......................... [RUN]
10:34:34  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882, now test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6)
10:34:34  Began compiling node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
10:34:34  Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
10:34:34  Began executing node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
10:34:34  Writing runtime sql for node "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
10:34:34  SQL status: SUCCESS in 1.202 seconds
10:34:34  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: ROLLBACK
10:34:34  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: Close
10:34:34  Using trino connection "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
10:34:34  19 of 24 PASS unique_dim_customer_INTEGRATION_ID ............................... [PASS in 1.23s]
10:34:34  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_product"
where product_id_WID is not null
group by product_id_WID
having count(*) > 1



      
    ) dbt_internal_test
10:34:34  Finished running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
10:34:34  Opening a new connection, currently in state closed
10:34:34  SQL status: SUCCESS in 1.206 seconds
10:34:34  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: ROLLBACK
10:34:34  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: Close
10:34:34  20 of 24 PASS unique_dim_customer_customer_id_WID .............................. [PASS in 1.24s]
10:34:34  Finished running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
10:34:34  SQL status: SUCCESS in 0.407 seconds
10:34:34  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: ROLLBACK
10:34:34  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: Close
10:34:34  23 of 24 PASS unique_dim_product_INTEGRATION_ID ................................ [PASS in 0.43s]
10:34:34  Finished running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
10:34:35  SQL status: SUCCESS in 0.356 seconds
10:34:35  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: ROLLBACK
10:34:35  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: Close
10:34:35  24 of 24 PASS unique_dim_product_product_id_WID ................................ [PASS in 0.41s]
10:34:35  Finished running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
10:34:35  On master: COMMIT
10:34:35  Connection 'master' was properly closed.
10:34:35  Connection 'test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6' was properly closed.
10:34:35  Connection 'test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5' was properly closed.
10:34:35  Connection 'test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987' was properly closed.
10:34:35  Connection 'test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165' was properly closed.
10:34:35  
10:34:35  Finished running 24 data tests in 0 hours 0 minutes and 4.77 seconds (4.77s).
10:34:35  Command end result
10:34:35  
10:34:35  Completed successfully
10:34:35  
10:34:35  Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
10:34:35  Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.9367733, "process_user_time": 12.97885, "process_kernel_time": 0.815583, "process_mem_max_rss": "129704", "process_in_blocks": "6704", "process_out_blocks": "3392"}
10:34:35  Command `dbt test` succeeded at 10:34:35.199456 after 5.94 seconds
10:34:35  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07542a2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0758097f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0758097310>]}
10:34:35  Flushing usage events
[0m15:38:01  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0048093050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00493ea510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00480e1bd0>]}
[0m15:38:01  Running with dbt=1.8.7
[0m15:38:01  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'log_format': 'text', 'invocation_command': 'dbt ls --profiles-dir . --target dev --quiet --resource-type model --output name --select fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0e0de4-6fde-4e86-b914-835f214fbe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0048090f10>]}
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0e0de4-6fde-4e86-b914-835f214fbe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0049e699d0>]}
[0m15:38:02  Registered adapter: trino=1.8.0
[0m15:38:02  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m15:38:02  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:02  Partial parsing enabled, no changes found, skipping parsing
[0m15:38:02  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0e0de4-6fde-4e86-b914-835f214fbe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0047bad5d0>]}
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0e0de4-6fde-4e86-b914-835f214fbe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0047cd44d0>]}
[0m15:38:02  Found 6 models, 24 data tests, 15 sources, 564 macros
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0e0de4-6fde-4e86-b914-835f214fbe09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0047c63f10>]}
[0m15:38:02  Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.2792968, "process_user_time": 3.030317, "process_kernel_time": 0.232289, "process_mem_max_rss": "115160", "process_in_blocks": "22888", "process_out_blocks": "1480"}
[0m15:38:02  Command `dbt ls` succeeded at 15:38:02.862989 after 1.28 seconds
[0m15:38:02  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0048294f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0047c61090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0047cd5d90>]}
[0m15:38:02  Flushing usage events
15:38:06  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2cfb990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2cfb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2cfa950>]}
15:38:06  Running with dbt=1.8.7
15:38:06  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'True', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'text', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --target dev --select fact_sales --debug --no-use-colors --fail-fast', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
15:38:07  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2c84450>]}
15:38:07  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc4819690>]}
15:38:07  Registered adapter: trino=1.8.0
15:38:07  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
15:38:07  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:38:07  Partial parsing enabled, no changes found, skipping parsing
15:38:07  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
15:38:07  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc27ebc90>]}
15:38:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc25f8a10>]}
15:38:07  Found 6 models, 24 data tests, 15 sources, 564 macros
15:38:07  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2657d90>]}
15:38:07  
15:38:07  Acquiring new trino connection 'master'
15:38:07  Acquiring new trino connection 'list_iceberg'
15:38:07  Using trino connection "list_iceberg"
15:38:07  On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
15:38:07  Opening a new connection, currently in state init
15:38:08  SQL status: SUCCESS in 0.573 seconds
15:38:08  On list_iceberg: Close
15:38:08  Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_gold)
15:38:08  Using trino connection "list_iceberg_gold"
15:38:08  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
15:38:08  Opening a new connection, currently in state closed
15:38:09  SQL status: SUCCESS in 0.433 seconds
15:38:09  On list_iceberg_gold: ROLLBACK
15:38:09  On list_iceberg_gold: Close
15:38:09  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc2657d90>]}
15:38:09  On master: COMMIT
15:38:09  Concurrency: 4 threads (target='dev')
15:38:09  
15:38:09  Began running node model.dbt_trino_project.fact_sales
15:38:09  1 of 1 START sql table model gold.fact_sales ................................... [RUN]
15:38:09  Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.fact_sales)
15:38:09  Began compiling node model.dbt_trino_project.fact_sales
15:38:09  Writing injected SQL for node "model.dbt_trino_project.fact_sales"
15:38:09  Began executing node model.dbt_trino_project.fact_sales
15:38:09  Writing runtime sql for node "model.dbt_trino_project.fact_sales"
15:38:09  Using trino connection "model.dbt_trino_project.fact_sales"
15:38:09  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

  
    

    create table "iceberg"."gold"."fact_sales__dbt_tmp"
      
      
    as (
      -- models/marts/fact_sales.sql


with stg_salesorderheader as (
    select
        salesorderid,
        customerid,
        creditcardid,
        shiptoaddressid,
        cast(status as bigint)       as order_status,
        cast(orderdate as date)      as orderdate,
        totaldue
    from "iceberg"."silver"."silver_sales_salesorderheader"
),

stg_salesorderdetail as (
    select
        salesorderid,
        salesorderdetailid,
        productid,
        orderqty,
        unitprice,
        (unitprice * orderqty) as revenue
    from "iceberg"."silver"."silver_sales_salesorderdetail"
)

select
    -- Grain: 1 row / (salesorderid, salesorderdetailid)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.salesorderid as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(d.salesorderdetailid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as sales_id_WID,

    -- FKs sang dims (hash từ natural keys)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.productid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as product_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.customerid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))       as customer_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as credit_card_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.shiptoaddressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))  as ship_address_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.order_status as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as order_status_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.orderdate as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as order_date_id_WID,

    -- Natural keys / trace
    d.salesorderid,
    d.salesorderdetailid,
    d.productid,
    h.customerid,
    h.creditcardid,
    h.shiptoaddressid,
    h.order_status,
    h.orderdate,

    -- Measures
    d.unitprice,
    d.orderqty,
    d.revenue,
    h.totaldue

from stg_salesorderdetail d
join stg_salesorderheader h
  on d.salesorderid = h.salesorderid
    )
15:38:09  Opening a new connection, currently in state closed
15:38:15  SQL status: SUCCESS in 6.327 seconds
15:38:15  Using trino connection "model.dbt_trino_project.fact_sales"
15:38:15  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales" rename to "iceberg"."gold"."fact_sales__dbt_backup"
15:38:16  SQL status: SUCCESS in 0.531 seconds
15:38:16  Using trino connection "model.dbt_trino_project.fact_sales"
15:38:16  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales__dbt_tmp" rename to "iceberg"."gold"."fact_sales"
15:38:16  SQL status: SUCCESS in 0.182 seconds
15:38:16  Applying DROP to: "iceberg"."gold"."fact_sales__dbt_backup"
15:38:16  Using trino connection "model.dbt_trino_project.fact_sales"
15:38:16  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

    drop table if exists "iceberg"."gold"."fact_sales__dbt_backup"
15:38:16  SQL status: SUCCESS in 0.290 seconds
15:38:16  On model.dbt_trino_project.fact_sales: ROLLBACK
15:38:16  On model.dbt_trino_project.fact_sales: Close
15:38:16  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7a18a7-6e2a-4f95-bf03-f5de306e49f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc1b1d990>]}
15:38:16  1 of 1 OK created sql table model gold.fact_sales .............................. [SUCCESS in 7.57s]
15:38:16  Finished running node model.dbt_trino_project.fact_sales
15:38:16  On master: COMMIT
15:38:16  Connection 'master' was properly closed.
15:38:16  Connection 'model.dbt_trino_project.fact_sales' was properly closed.
15:38:16  
15:38:16  Finished running 1 table model in 0 hours 0 minutes and 8.72 seconds (8.72s).
15:38:16  Command end result
15:38:16  
15:38:16  Completed successfully
15:38:16  
15:38:16  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:38:16  Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.8172245, "process_user_time": 4.463564, "process_kernel_time": 0.385868, "process_mem_max_rss": "123416", "process_in_blocks": "2768", "process_out_blocks": "2840"}
15:38:16  Command `dbt run` succeeded at 15:38:16.697937 after 9.82 seconds
15:38:16  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc6e1ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc6e1f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc6eac7d0>]}
15:38:16  Flushing usage events
15:38:22  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a07117b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a08472510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a07117a50>]}
15:38:22  Running with dbt=1.8.7
15:38:22  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'text', 'invocation_command': 'dbt test --profiles-dir . --target dev --select fact_sales --debug --no-use-colors --fail-fast', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
15:38:23  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d3c82b-1114-4938-b0e2-ebba505b6d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a07117090>]}
15:38:23  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d3c82b-1114-4938-b0e2-ebba505b6d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a08e88f50>]}
15:38:23  Registered adapter: trino=1.8.0
15:38:23  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
15:38:23  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:38:23  Partial parsing enabled, no changes found, skipping parsing
15:38:23  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
15:38:23  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d3c82b-1114-4938-b0e2-ebba505b6d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a06c30d90>]}
15:38:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d3c82b-1114-4938-b0e2-ebba505b6d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a068dbc10>]}
15:38:23  Found 6 models, 24 data tests, 15 sources, 564 macros
15:38:23  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d3c82b-1114-4938-b0e2-ebba505b6d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a06b74bd0>]}
15:38:23  
15:38:23  Nothing to do. Try checking your model configs and model specification args
15:38:23  Command end result
15:38:23  Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1196935, "process_user_time": 3.029444, "process_kernel_time": 0.299842, "process_mem_max_rss": "114120", "process_in_blocks": "872", "process_out_blocks": "2808"}
15:38:23  Command `dbt test` succeeded at 15:38:23.883781 after 1.12 seconds
15:38:23  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a06ce9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0b247350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0b247fd0>]}
15:38:23  Flushing usage events
[0m16:21:55  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56974d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56977f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56977090>]}
[0m16:21:55  Running with dbt=1.8.7
[0m16:21:55  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'True', 'empty': 'None', 'log_format': 'text', 'static_parser': 'True', 'invocation_command': 'dbt ls --profiles-dir . --target dev --quiet --resource-type model --output name --select tag:gold', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:55  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c43af7fe-60d4-4c4a-8552-d0b33adba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56704310>]}
[0m16:21:55  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c43af7fe-60d4-4c4a-8552-d0b33adba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a586d9ad0>]}
[0m16:21:55  Registered adapter: trino=1.8.0
[0m16:21:56  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m16:21:56  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:56  Partial parsing enabled, no changes found, skipping parsing
[0m16:21:56  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m16:21:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c43af7fe-60d4-4c4a-8552-d0b33adba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a564902d0>]}
[0m16:21:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c43af7fe-60d4-4c4a-8552-d0b33adba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a561440d0>]}
[0m16:21:56  Found 6 models, 24 data tests, 15 sources, 564 macros
[0m16:21:56  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c43af7fe-60d4-4c4a-8552-d0b33adba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a563d0fd0>]}
[0m16:21:56  Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.2666358, "process_user_time": 2.941646, "process_kernel_time": 0.378211, "process_mem_max_rss": "115224", "process_in_blocks": "20688", "process_out_blocks": "1480"}
[0m16:21:56  Command `dbt ls` succeeded at 16:21:56.532156 after 1.27 seconds
[0m16:21:56  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a569d5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5aa93310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56c9e2d0>]}
[0m16:21:56  Flushing usage events
16:22:00  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf397550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe286ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf397b10>]}
16:22:00  Running with dbt=1.8.7
16:22:00  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev --select tag:gold --debug --no-use-colors --fail-fast', 'log_format': 'text', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
16:22:00  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf3f7e90>]}
16:22:00  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe06786d0>]}
16:22:00  Registered adapter: trino=1.8.0
16:22:00  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
16:22:01  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:22:01  Partial parsing enabled, no changes found, skipping parsing
16:22:01  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
16:22:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdeffa790>]}
16:22:01  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdee01510>]}
16:22:01  Found 6 models, 24 data tests, 15 sources, 564 macros
16:22:01  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe0bc65d0>]}
16:22:01  
16:22:01  Acquiring new trino connection 'master'
16:22:01  Acquiring new trino connection 'list_iceberg'
16:22:01  Using trino connection "list_iceberg"
16:22:01  On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
16:22:01  Opening a new connection, currently in state init
16:22:01  SQL status: SUCCESS in 0.559 seconds
16:22:01  On list_iceberg: Close
16:22:01  Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_gold)
16:22:02  Using trino connection "list_iceberg_gold"
16:22:02  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
16:22:02  Opening a new connection, currently in state closed
16:22:02  SQL status: SUCCESS in 0.649 seconds
16:22:02  On list_iceberg_gold: ROLLBACK
16:22:02  On list_iceberg_gold: Close
16:22:02  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fded00110>]}
16:22:02  On master: COMMIT
16:22:02  Concurrency: 4 threads (target='dev')
16:22:02  
16:22:02  Began running node model.dbt_trino_project.dim_address
16:22:02  Began running node model.dbt_trino_project.dim_credit_card
16:22:02  Began running node model.dbt_trino_project.dim_customer
16:22:02  1 of 6 START sql table model gold.dim_address .................................. [RUN]
16:22:02  Began running node model.dbt_trino_project.dim_order_status
16:22:02  2 of 6 START sql table model gold.dim_credit_card .............................. [RUN]
16:22:02  3 of 6 START sql table model gold.dim_customer ................................. [RUN]
16:22:02  Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.dim_address)
16:22:02  4 of 6 START sql table model gold.dim_order_status ............................. [RUN]
16:22:02  Acquiring new trino connection 'model.dbt_trino_project.dim_credit_card'
16:22:02  Acquiring new trino connection 'model.dbt_trino_project.dim_customer'
16:22:02  Began compiling node model.dbt_trino_project.dim_address
16:22:02  Acquiring new trino connection 'model.dbt_trino_project.dim_order_status'
16:22:02  Began compiling node model.dbt_trino_project.dim_credit_card
16:22:02  Began compiling node model.dbt_trino_project.dim_customer
16:22:02  Began compiling node model.dbt_trino_project.dim_order_status
16:22:02  Writing injected SQL for node "model.dbt_trino_project.dim_address"
16:22:02  Writing injected SQL for node "model.dbt_trino_project.dim_credit_card"
16:22:02  Writing injected SQL for node "model.dbt_trino_project.dim_customer"
16:22:02  Writing injected SQL for node "model.dbt_trino_project.dim_order_status"
16:22:02  Began executing node model.dbt_trino_project.dim_credit_card
16:22:02  Began executing node model.dbt_trino_project.dim_customer
16:22:02  Began executing node model.dbt_trino_project.dim_address
16:22:02  Began executing node model.dbt_trino_project.dim_order_status
16:22:02  Writing runtime sql for node "model.dbt_trino_project.dim_order_status"
16:22:02  Writing runtime sql for node "model.dbt_trino_project.dim_address"
16:22:02  Writing runtime sql for node "model.dbt_trino_project.dim_credit_card"
16:22:02  Writing runtime sql for node "model.dbt_trino_project.dim_customer"
16:22:02  Using trino connection "model.dbt_trino_project.dim_order_status"
16:22:02  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */

  
    

    create table "iceberg"."gold"."dim_order_status__dbt_tmp"
      
      
    as (
      

-- Lấy các trạng thái đơn hàng duy nhất từ SalesOrderHeader
with src as (
  select distinct status as order_status
  from "iceberg"."silver"."silver_sales_salesorderheader"
)

select
  -- Surrogate key ổn định theo status
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(order_status as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as order_status_id_WID,

  -- Business key
  order_status as INTEGRATION_ID,

  -- Tên hiển thị (AdventureWorks conventions)
  case order_status
    when 1 then 'In Process'
    when 2 then 'Approved'
    when 3 then 'Backordered'
    when 4 then 'Rejected'
    when 5 then 'Shipped'
    when 6 then 'Cancelled'
    else 'Unknown'
  end as order_status_name

from src
    )
16:22:02  Using trino connection "model.dbt_trino_project.dim_credit_card"
16:22:02  Using trino connection "model.dbt_trino_project.dim_address"
16:22:02  Opening a new connection, currently in state init
16:22:02  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

  
    

    create table "iceberg"."gold"."dim_credit_card__dbt_tmp"
      
      
    as (
      -- models/marts/dim_credit_card.sql


with stg_salesorderheader as (
    select distinct
        creditcardid
    from "iceberg"."silver"."silver_sales_salesorderheader"
    where creditcardid is not null
),

stg_creditcard as (
    select
        creditcardid,
        cardtype
    from "iceberg"."silver"."silver_sales_creditcard"
)

select
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(stg_salesorderheader.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as credit_card_id_WID,
    cast(stg_salesorderheader.creditcardid as bigint) as INTEGRATION_ID,
    stg_creditcard.cardtype
from stg_salesorderheader
left join stg_creditcard
  on stg_salesorderheader.creditcardid = stg_creditcard.creditcardid
    )
16:22:02  Using trino connection "model.dbt_trino_project.dim_customer"
16:22:02  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

  
    

    create table "iceberg"."gold"."dim_address__dbt_tmp"
      
      
    as (
      

with stg_address as (
  select * from "iceberg"."silver"."silver_person_address"
),
stg_stateprovince as (
  select * from "iceberg"."silver"."silver_person_stateprovince"
),
stg_countryregion as (
  select * from "iceberg"."silver"."silver_person_countryregion"
)

select
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(a.addressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as address_id_WID,
  a.addressid as INTEGRATION_ID,

  -- Thuộc tính mô tả
  a.addressline1,
  a.addressline2,
  a.city,
  a.postalcode,

  -- State/Province
  cast(a.stateprovinceid as bigint) as stateprovinceid,
  sp.stateprovincecode,
  sp.name as stateprovince_name,

  -- Country/Region
  sp.countryregioncode,
  cr.name as country_name,

  -- Phụ trợ
  a.spatiallocation,
  a.rowguid,
  a.modifieddate

from stg_address a
left join stg_stateprovince sp
  on cast(a.stateprovinceid as bigint) = sp.stateprovinceid
left join stg_countryregion cr
  on sp.countryregioncode = cr.countryregioncode
    )
16:22:02  Opening a new connection, currently in state init
16:22:02  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */

  
    

    create table "iceberg"."gold"."dim_customer__dbt_tmp"
      
      
    as (
      -- models/marts/dim_customer.sql


with stg_customer as (
  select
      customerid,
      try_cast(personid as bigint) as personid,
      try_cast(storeid  as bigint) as storeid
  from "iceberg"."silver"."silver_sales_customer"
),

stg_person as (
  select
      businessentityid,
      -- build fullname, gọn và sạch khoảng trắng
      trim(
        regexp_replace(
          concat(
            coalesce(firstname, ''),
            ' ',
            coalesce(middlename, ''),
            ' ',
            coalesce(lastname, '')
          ),
          '\\s+',
          ' '
        )
      ) as fullname
  from "iceberg"."silver"."silver_person_person"
),

stg_store as (
  select
      businessentityid as storebusinessentityid,
      name as storename
  from "iceberg"."silver"."silver_sales_store"
)

select
  -- SKey ổn định theo customerid
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(stg_customer.customerid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as customer_id_WID,

  -- Business key gốc
  cast(stg_customer.customerid as bigint) as INTEGRATION_ID,

  -- Person
  stg_person.businessentityid,
  stg_person.fullname,

  -- Store
  stg_store.storebusinessentityid,
  stg_store.storename

from stg_customer
left join stg_person
  on stg_customer.personid = stg_person.businessentityid
left join stg_store
  on stg_customer.storeid = stg_store.storebusinessentityid
    )
16:22:02  Opening a new connection, currently in state closed
16:22:02  Opening a new connection, currently in state init
16:22:04  SQL status: SUCCESS in 1.305 seconds
16:22:04  Using trino connection "model.dbt_trino_project.dim_order_status"
16:22:04  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */
alter table "iceberg"."gold"."dim_order_status" rename to "iceberg"."gold"."dim_order_status__dbt_backup"
16:22:04  SQL status: SUCCESS in 0.240 seconds
16:22:04  Using trino connection "model.dbt_trino_project.dim_order_status"
16:22:04  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */
alter table "iceberg"."gold"."dim_order_status__dbt_tmp" rename to "iceberg"."gold"."dim_order_status"
16:22:04  SQL status: SUCCESS in 1.720 seconds
16:22:04  Using trino connection "model.dbt_trino_project.dim_credit_card"
16:22:04  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */
alter table "iceberg"."gold"."dim_credit_card" rename to "iceberg"."gold"."dim_credit_card__dbt_backup"
16:22:04  SQL status: SUCCESS in 0.233 seconds
16:22:04  Applying DROP to: "iceberg"."gold"."dim_order_status__dbt_backup"
16:22:04  Using trino connection "model.dbt_trino_project.dim_order_status"
16:22:04  On model.dbt_trino_project.dim_order_status: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_order_status"} */

    drop table if exists "iceberg"."gold"."dim_order_status__dbt_backup"
16:22:04  SQL status: SUCCESS in 1.995 seconds
16:22:04  Using trino connection "model.dbt_trino_project.dim_customer"
16:22:04  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */
alter table "iceberg"."gold"."dim_customer" rename to "iceberg"."gold"."dim_customer__dbt_backup"
16:22:04  SQL status: SUCCESS in 0.291 seconds
16:22:04  Using trino connection "model.dbt_trino_project.dim_credit_card"
16:22:05  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */
alter table "iceberg"."gold"."dim_credit_card__dbt_tmp" rename to "iceberg"."gold"."dim_credit_card"
16:22:05  SQL status: SUCCESS in 2.090 seconds
16:22:05  Using trino connection "model.dbt_trino_project.dim_address"
16:22:05  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */
alter table "iceberg"."gold"."dim_address" rename to "iceberg"."gold"."dim_address__dbt_backup"
16:22:05  SQL status: SUCCESS in 0.299 seconds
16:22:05  On model.dbt_trino_project.dim_order_status: ROLLBACK
16:22:05  On model.dbt_trino_project.dim_order_status: Close
16:22:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fddf4d3d0>]}
16:22:05  4 of 6 OK created sql table model gold.dim_order_status ........................ [SUCCESS in 2.43s]
16:22:05  Finished running node model.dbt_trino_project.dim_order_status
16:22:05  Began running node model.dbt_trino_project.dim_product
16:22:05  5 of 6 START sql table model gold.dim_product .................................. [RUN]
16:22:05  Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_order_status, now model.dbt_trino_project.dim_product)
16:22:05  Began compiling node model.dbt_trino_project.dim_product
16:22:05  Writing injected SQL for node "model.dbt_trino_project.dim_product"
16:22:05  Began executing node model.dbt_trino_project.dim_product
16:22:05  Writing runtime sql for node "model.dbt_trino_project.dim_product"
16:22:05  Using trino connection "model.dbt_trino_project.dim_product"
16:22:05  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */

  
    

    create table "iceberg"."gold"."dim_product__dbt_tmp"
      
      
    as (
      

with stg_product as (
  select * from "iceberg"."silver"."silver_production_product"
),
stg_product_subcateg as (
  select * from "iceberg"."silver"."silver_production_productsubcategory"
),
stg_product_category as (
  select * from "iceberg"."silver"."silver_production_productcategory"
)

select
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(p.productid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as product_id_WID,
  p.productid as INTEGRATION_ID,
  p.name as product_name,
  p.productnumber,
  p.makeflag,
  p.finishedgoodsflag,
  p.color,
  p.productline,
  p.class,
  p.style,
  p.size,
  p.sizeunitmeasurecode,
  p.weightunitmeasurecode,
  p.weight,
  p.safetystocklevel,
  p.reorderpoint,
  p.standardcost,
  p.listprice,
  p.daystomanufacture,
  p.sellstartdate,
  p.sellenddate,
  p.discontinueddate,
  cast(p.productsubcategoryid as bigint) as productsubcategoryid,
  psc.name as product_subcategory_name,
  pc.productcategoryid,
  pc.name as product_category_name
from stg_product p
left join stg_product_subcateg psc
  on cast(p.productsubcategoryid as bigint) = psc.productsubcategoryid
left join stg_product_category pc
  on psc.productcategoryid = pc.productcategoryid
    )
16:22:05  Opening a new connection, currently in state closed
16:22:05  SQL status: SUCCESS in 0.340 seconds
16:22:05  Using trino connection "model.dbt_trino_project.dim_customer"
16:22:05  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */
alter table "iceberg"."gold"."dim_customer__dbt_tmp" rename to "iceberg"."gold"."dim_customer"
16:22:05  SQL status: SUCCESS in 0.340 seconds
16:22:05  Applying DROP to: "iceberg"."gold"."dim_credit_card__dbt_backup"
16:22:05  Using trino connection "model.dbt_trino_project.dim_credit_card"
16:22:05  On model.dbt_trino_project.dim_credit_card: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_credit_card"} */

    drop table if exists "iceberg"."gold"."dim_credit_card__dbt_backup"
16:22:05  SQL status: SUCCESS in 0.302 seconds
16:22:05  Using trino connection "model.dbt_trino_project.dim_address"
16:22:05  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */
alter table "iceberg"."gold"."dim_address__dbt_tmp" rename to "iceberg"."gold"."dim_address"
16:22:05  SQL status: SUCCESS in 0.358 seconds
16:22:05  Applying DROP to: "iceberg"."gold"."dim_customer__dbt_backup"
16:22:05  Using trino connection "model.dbt_trino_project.dim_customer"
16:22:05  On model.dbt_trino_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_customer"} */

    drop table if exists "iceberg"."gold"."dim_customer__dbt_backup"
16:22:05  SQL status: SUCCESS in 0.365 seconds
16:22:05  Applying DROP to: "iceberg"."gold"."dim_address__dbt_backup"
16:22:05  Using trino connection "model.dbt_trino_project.dim_address"
16:22:05  On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

    drop table if exists "iceberg"."gold"."dim_address__dbt_backup"
16:22:05  SQL status: SUCCESS in 0.433 seconds
16:22:05  On model.dbt_trino_project.dim_credit_card: ROLLBACK
16:22:05  On model.dbt_trino_project.dim_credit_card: Close
16:22:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe140e190>]}
16:22:05  2 of 6 OK created sql table model gold.dim_credit_card ......................... [SUCCESS in 3.13s]
16:22:05  Finished running node model.dbt_trino_project.dim_credit_card
16:22:05  Began running node model.dbt_trino_project.fact_sales
16:22:05  6 of 6 START sql table model gold.fact_sales ................................... [RUN]
16:22:05  Re-using an available connection from the pool (formerly model.dbt_trino_project.dim_credit_card, now model.dbt_trino_project.fact_sales)
16:22:05  Began compiling node model.dbt_trino_project.fact_sales
16:22:05  Writing injected SQL for node "model.dbt_trino_project.fact_sales"
16:22:05  Began executing node model.dbt_trino_project.fact_sales
16:22:05  Writing runtime sql for node "model.dbt_trino_project.fact_sales"
16:22:05  Using trino connection "model.dbt_trino_project.fact_sales"
16:22:05  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

  
    

    create table "iceberg"."gold"."fact_sales__dbt_tmp"
      
      
    as (
      -- models/marts/fact_sales.sql


with stg_salesorderheader as (
    select
        salesorderid,
        customerid,
        creditcardid,
        shiptoaddressid,
        cast(status as bigint)       as order_status,
        cast(orderdate as date)      as orderdate,
        totaldue
    from "iceberg"."silver"."silver_sales_salesorderheader"
),

stg_salesorderdetail as (
    select
        salesorderid,
        salesorderdetailid,
        productid,
        orderqty,
        unitprice,
        (unitprice * orderqty) as revenue
    from "iceberg"."silver"."silver_sales_salesorderdetail"
)

select
    -- Grain: 1 row / (salesorderid, salesorderdetailid)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.salesorderid as varchar), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(d.salesorderdetailid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as sales_id_WID,

    -- FKs sang dims (hash từ natural keys)
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(d.productid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as product_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.customerid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))       as customer_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.creditcardid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as credit_card_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.shiptoaddressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))  as ship_address_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.order_status as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))     as order_status_id_WID,
    lower(to_hex(md5(to_utf8(cast(coalesce(cast(h.orderdate as varchar), '_dbt_utils_surrogate_key_null_') as varchar)))))        as order_date_id_WID,

    -- Natural keys / trace
    d.salesorderid,
    d.salesorderdetailid,
    d.productid,
    h.customerid,
    h.creditcardid,
    h.shiptoaddressid,
    h.order_status,
    h.orderdate,

    -- Measures
    d.unitprice,
    d.orderqty,
    d.revenue,
    h.totaldue

from stg_salesorderdetail d
join stg_salesorderheader h
  on d.salesorderid = h.salesorderid
    )
16:22:05  Opening a new connection, currently in state closed
16:22:06  SQL status: SUCCESS in 0.502 seconds
16:22:06  On model.dbt_trino_project.dim_customer: ROLLBACK
16:22:06  On model.dbt_trino_project.dim_customer: Close
16:22:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdded9810>]}
16:22:06  3 of 6 OK created sql table model gold.dim_customer ............................ [SUCCESS in 3.53s]
16:22:06  Finished running node model.dbt_trino_project.dim_customer
16:22:06  SQL status: SUCCESS in 0.575 seconds
16:22:06  On model.dbt_trino_project.dim_address: ROLLBACK
16:22:06  On model.dbt_trino_project.dim_address: Close
16:22:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdec9bd90>]}
16:22:06  1 of 6 OK created sql table model gold.dim_address ............................. [SUCCESS in 3.67s]
16:22:06  Finished running node model.dbt_trino_project.dim_address
16:22:06  SQL status: SUCCESS in 1.471 seconds
16:22:06  Using trino connection "model.dbt_trino_project.dim_product"
16:22:06  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */
alter table "iceberg"."gold"."dim_product" rename to "iceberg"."gold"."dim_product__dbt_backup"
16:22:07  SQL status: SUCCESS in 0.551 seconds
16:22:07  Using trino connection "model.dbt_trino_project.dim_product"
16:22:07  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */
alter table "iceberg"."gold"."dim_product__dbt_tmp" rename to "iceberg"."gold"."dim_product"
16:22:07  SQL status: SUCCESS in 0.194 seconds
16:22:07  Applying DROP to: "iceberg"."gold"."dim_product__dbt_backup"
16:22:07  Using trino connection "model.dbt_trino_project.dim_product"
16:22:07  On model.dbt_trino_project.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_product"} */

    drop table if exists "iceberg"."gold"."dim_product__dbt_backup"
16:22:07  SQL status: SUCCESS in 0.219 seconds
16:22:07  On model.dbt_trino_project.dim_product: ROLLBACK
16:22:07  On model.dbt_trino_project.dim_product: Close
16:22:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdc5f9b50>]}
16:22:07  5 of 6 OK created sql table model gold.dim_product ............................. [SUCCESS in 2.49s]
16:22:07  Finished running node model.dbt_trino_project.dim_product
16:22:11  SQL status: SUCCESS in 5.605 seconds
16:22:11  Using trino connection "model.dbt_trino_project.fact_sales"
16:22:11  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales" rename to "iceberg"."gold"."fact_sales__dbt_backup"
16:22:11  SQL status: SUCCESS in 0.074 seconds
16:22:11  Using trino connection "model.dbt_trino_project.fact_sales"
16:22:11  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */
alter table "iceberg"."gold"."fact_sales__dbt_tmp" rename to "iceberg"."gold"."fact_sales"
16:22:11  SQL status: SUCCESS in 0.079 seconds
16:22:11  Applying DROP to: "iceberg"."gold"."fact_sales__dbt_backup"
16:22:11  Using trino connection "model.dbt_trino_project.fact_sales"
16:22:11  On model.dbt_trino_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.fact_sales"} */

    drop table if exists "iceberg"."gold"."fact_sales__dbt_backup"
16:22:11  SQL status: SUCCESS in 0.140 seconds
16:22:11  On model.dbt_trino_project.fact_sales: ROLLBACK
16:22:11  On model.dbt_trino_project.fact_sales: Close
16:22:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e819cc3b-45ec-45d9-a1aa-98f34d9b0742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe07bd210>]}
16:22:11  6 of 6 OK created sql table model gold.fact_sales .............................. [SUCCESS in 5.99s]
16:22:11  Finished running node model.dbt_trino_project.fact_sales
16:22:11  On master: COMMIT
16:22:11  Connection 'master' was properly closed.
16:22:11  Connection 'model.dbt_trino_project.dim_address' was properly closed.
16:22:11  Connection 'model.dbt_trino_project.fact_sales' was properly closed.
16:22:11  Connection 'model.dbt_trino_project.dim_customer' was properly closed.
16:22:11  Connection 'model.dbt_trino_project.dim_product' was properly closed.
16:22:11  
16:22:11  Finished running 6 table models in 0 hours 0 minutes and 10.49 seconds (10.49s).
16:22:11  Command end result
16:22:11  
16:22:11  Completed successfully
16:22:11  
16:22:11  Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
16:22:11  Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.63618, "process_user_time": 10.615638, "process_kernel_time": 0.662819, "process_mem_max_rss": "127448", "process_in_blocks": "4000", "process_out_blocks": "3088"}
16:22:11  Command `dbt run` succeeded at 16:22:11.891883 after 11.64 seconds
16:22:11  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe34b3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe34b3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fdf6be310>]}
16:22:11  Flushing usage events
16:22:18  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b4a7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b507ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b4a7ed0>]}
16:22:18  Running with dbt=1.8.7
16:22:18  running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'True', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir . --target dev --select tag:gold --debug --no-use-colors --fail-fast', 'introspect': 'True', 'target_path': 'None', 'log_format': 'text', 'send_anonymous_usage_stats': 'True'}
16:22:18  Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b2d9a10>]}
16:22:18  Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d218f90>]}
16:22:18  Registered adapter: trino=1.8.0
16:22:18  checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
16:22:18  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:22:18  Partial parsing enabled, no changes found, skipping parsing
16:22:18  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
16:22:18  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b0338d0>]}
16:22:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518ac26590>]}
16:22:19  Found 6 models, 24 data tests, 15 sources, 564 macros
16:22:19  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b288750>]}
16:22:19  
16:22:19  Acquiring new trino connection 'master'
16:22:19  Acquiring new trino connection 'list_iceberg_gold'
16:22:19  Using trino connection "list_iceberg_gold"
16:22:19  On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
16:22:19  Opening a new connection, currently in state init
16:22:19  SQL status: SUCCESS in 0.668 seconds
16:22:19  On list_iceberg_gold: ROLLBACK
16:22:19  On list_iceberg_gold: Close
16:22:19  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8e066b-df25-44af-bc40-b9f09b49b56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518afe0690>]}
16:22:19  On master: COMMIT
16:22:19  Concurrency: 4 threads (target='dev')
16:22:19  
16:22:19  Began running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
16:22:19  Began running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
16:22:19  Began running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
16:22:19  1 of 24 START test not_null_dim_address_INTEGRATION_ID ......................... [RUN]
16:22:19  Began running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
16:22:19  2 of 24 START test not_null_dim_address_address_id_WID ......................... [RUN]
16:22:19  3 of 24 START test not_null_dim_address_addressline1 ........................... [RUN]
16:22:19  Re-using an available connection from the pool (formerly list_iceberg_gold, now test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563)
16:22:19  4 of 24 START test not_null_dim_credit_card_INTEGRATION_ID ..................... [RUN]
16:22:19  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f'
16:22:19  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8'
16:22:19  Began compiling node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
16:22:19  Acquiring new trino connection 'test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa'
16:22:19  Began compiling node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
16:22:19  Began compiling node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
16:22:20  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"
16:22:20  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
16:22:20  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select address_id_WID
from "iceberg"."gold"."dim_address"
where address_id_WID is null



      
    ) dbt_internal_test
16:22:20  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select addressline1
from "iceberg"."gold"."dim_address"
where addressline1 is null



      
    ) dbt_internal_test
16:22:20  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_address"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
16:22:20  Opening a new connection, currently in state init
16:22:20  Opening a new connection, currently in state init
16:22:20  Opening a new connection, currently in state init
16:22:20  Opening a new connection, currently in state closed
16:22:20  SQL status: SUCCESS in 0.511 seconds
16:22:20  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: ROLLBACK
16:22:20  On test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563: Close
16:22:20  1 of 24 PASS not_null_dim_address_INTEGRATION_ID ............................... [PASS in 0.62s]
16:22:20  SQL status: SUCCESS in 0.525 seconds
16:22:20  Finished running node test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563
16:22:20  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: ROLLBACK
16:22:20  Began running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
16:22:20  SQL status: SUCCESS in 0.533 seconds
16:22:20  On test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa: Close
16:22:20  5 of 24 START test not_null_dim_credit_card_cardtype ........................... [RUN]
16:22:20  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: ROLLBACK
16:22:20  4 of 24 PASS not_null_dim_credit_card_INTEGRATION_ID ........................... [PASS in 0.63s]
16:22:20  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_INTEGRATION_ID.d79fb1e563, now test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d)
16:22:20  On test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8: Close
16:22:20  Finished running node test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa
16:22:20  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
16:22:20  3 of 24 PASS not_null_dim_address_addressline1 ................................. [PASS in 0.64s]
16:22:20  Began running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
16:22:20  Finished running node test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8
16:22:20  6 of 24 START test not_null_dim_credit_card_credit_card_id_WID ................. [RUN]
16:22:20  Began running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
16:22:20  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_INTEGRATION_ID.e719fd8bfa, now test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b)
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
16:22:20  7 of 24 START test not_null_dim_customer_INTEGRATION_ID ........................ [RUN]
16:22:20  Began compiling node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
16:22:20  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_addressline1.2b8e64b1d8, now test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a)
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
16:22:20  Began compiling node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"
16:22:20  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cardtype
from "iceberg"."gold"."dim_credit_card"
where cardtype is null



      
    ) dbt_internal_test
16:22:20  Opening a new connection, currently in state closed
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
16:22:20  SQL status: SUCCESS in 0.601 seconds
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"
16:22:20  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: ROLLBACK
16:22:20  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select credit_card_id_WID
from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is null



      
    ) dbt_internal_test
16:22:20  On test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f: Close
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"
16:22:20  Opening a new connection, currently in state closed
16:22:20  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_customer"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
16:22:20  2 of 24 PASS not_null_dim_address_address_id_WID ............................... [PASS in 0.71s]
16:22:20  Opening a new connection, currently in state closed
16:22:20  Finished running node test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f
16:22:20  Began running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
16:22:20  8 of 24 START test not_null_dim_customer_customer_id_WID ....................... [RUN]
16:22:20  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_address_address_id_WID.3519524d3f, now test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800)
16:22:20  Began compiling node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
16:22:20  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
16:22:20  Began executing node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
16:22:20  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
16:22:20  Using trino connection "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"
16:22:20  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id_WID
from "iceberg"."gold"."dim_customer"
where customer_id_WID is null



      
    ) dbt_internal_test
16:22:20  Opening a new connection, currently in state closed
16:22:21  SQL status: SUCCESS in 0.426 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: ROLLBACK
16:22:21  On test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d: Close
16:22:21  5 of 24 PASS not_null_dim_credit_card_cardtype ................................. [PASS in 0.48s]
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d
16:22:21  Began running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
16:22:21  9 of 24 START test not_null_dim_order_status_INTEGRATION_ID .................... [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_cardtype.ee3e3af84d, now test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0)
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"
16:22:21  SQL status: SUCCESS in 0.431 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_order_status"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
16:22:21  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: ROLLBACK
16:22:21  Opening a new connection, currently in state closed
16:22:21  On test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b: Close
16:22:21  SQL status: SUCCESS in 0.434 seconds
16:22:21  6 of 24 PASS not_null_dim_credit_card_credit_card_id_WID ....................... [PASS in 0.50s]
16:22:21  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: ROLLBACK
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b
16:22:21  On test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a: Close
16:22:21  Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
16:22:21  10 of 24 START test not_null_dim_order_status_order_status_id_WID .............. [RUN]
16:22:21  7 of 24 PASS not_null_dim_customer_INTEGRATION_ID .............................. [PASS in 0.50s]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_credit_card_credit_card_id_WID.772c616f4b, now test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308)
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
16:22:21  Began running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
16:22:21  11 of 24 START test not_null_dim_order_status_order_status_name ................ [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_INTEGRATION_ID.6293aab95a, now test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1)
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
16:22:21  SQL status: SUCCESS in 0.463 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status_id_WID
from "iceberg"."gold"."dim_order_status"
where order_status_id_WID is null



      
    ) dbt_internal_test
16:22:21  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: ROLLBACK
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"
16:22:21  Opening a new connection, currently in state closed
16:22:21  On test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800: Close
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_status_name
from "iceberg"."gold"."dim_order_status"
where order_status_name is null



      
    ) dbt_internal_test
16:22:21  8 of 24 PASS not_null_dim_customer_customer_id_WID ............................. [PASS in 0.50s]
16:22:21  Opening a new connection, currently in state closed
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800
16:22:21  Began running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
16:22:21  12 of 24 START test not_null_dim_product_INTEGRATION_ID ........................ [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_customer_customer_id_WID.e98d1f6800, now test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d)
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"
16:22:21  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select INTEGRATION_ID
from "iceberg"."gold"."dim_product"
where INTEGRATION_ID is null



      
    ) dbt_internal_test
16:22:21  Opening a new connection, currently in state closed
16:22:21  SQL status: SUCCESS in 0.457 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: ROLLBACK
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0: Close
16:22:21  9 of 24 PASS not_null_dim_order_status_INTEGRATION_ID .......................... [PASS in 0.50s]
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0
16:22:21  Began running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
16:22:21  13 of 24 START test not_null_dim_product_product_id_WID ........................ [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_INTEGRATION_ID.7e1a851fd0, now test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656)
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"
16:22:21  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id_WID
from "iceberg"."gold"."dim_product"
where product_id_WID is null



      
    ) dbt_internal_test
16:22:21  Opening a new connection, currently in state closed
16:22:21  SQL status: SUCCESS in 0.447 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: ROLLBACK
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308: Close
16:22:21  10 of 24 PASS not_null_dim_order_status_order_status_id_WID .................... [PASS in 0.51s]
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308
16:22:21  Began running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
16:22:21  14 of 24 START test not_null_dim_product_product_name .......................... [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_id_WID.b790d4b308, now test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5)
16:22:21  Began compiling node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
16:22:21  Writing injected SQL for node "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
16:22:21  Began executing node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
16:22:21  Writing runtime sql for node "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
16:22:21  Using trino connection "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"
16:22:21  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "iceberg"."gold"."dim_product"
where product_name is null



      
    ) dbt_internal_test
16:22:21  Opening a new connection, currently in state closed
16:22:21  SQL status: SUCCESS in 0.485 seconds
16:22:21  SQL status: SUCCESS in 0.464 seconds
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: ROLLBACK
16:22:21  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: ROLLBACK
16:22:21  On test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1: Close
16:22:21  On test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d: Close
16:22:21  11 of 24 PASS not_null_dim_order_status_order_status_name ...................... [PASS in 0.54s]
16:22:21  12 of 24 PASS not_null_dim_product_INTEGRATION_ID .............................. [PASS in 0.50s]
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1
16:22:21  Finished running node test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d
16:22:21  Began running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
16:22:21  Began running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
16:22:21  15 of 24 START test unique_dim_address_INTEGRATION_ID .......................... [RUN]
16:22:21  16 of 24 START test unique_dim_address_address_id_WID .......................... [RUN]
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_order_status_order_status_name.62835c73b1, now test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172)
16:22:21  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_INTEGRATION_ID.a68b21f43d, now test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978)
16:22:21  Began compiling node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
16:22:21  Began compiling node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
16:22:21  Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
16:22:21  Writing injected SQL for node "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
16:22:21  Began executing node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
16:22:21  Began executing node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
16:22:21  Writing runtime sql for node "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
16:22:21  Writing runtime sql for node "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
16:22:21  Using trino connection "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"
16:22:21  Using trino connection "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"
16:22:21  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    address_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_address"
where address_id_WID is not null
group by address_id_WID
having count(*) > 1



      
    ) dbt_internal_test
16:22:21  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_address"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
16:22:21  Opening a new connection, currently in state closed
16:22:21  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.415 seconds
16:22:22  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: ROLLBACK
16:22:22  On test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656: Close
16:22:22  13 of 24 PASS not_null_dim_product_product_id_WID .............................. [PASS in 0.44s]
16:22:22  Finished running node test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656
16:22:22  Began running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
16:22:22  17 of 24 START test unique_dim_credit_card_INTEGRATION_ID ...................... [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_product_id_WID.fcba11d656, now test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  SQL status: SUCCESS in 0.395 seconds
16:22:22  Opening a new connection, currently in state closed
16:22:22  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: ROLLBACK
16:22:22  On test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5: Close
16:22:22  14 of 24 PASS not_null_dim_product_product_name ................................ [PASS in 0.43s]
16:22:22  Finished running node test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5
16:22:22  Began running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
16:22:22  18 of 24 START test unique_dim_credit_card_credit_card_id_WID .................. [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.not_null_dim_product_product_name.1b672622d5, now test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    credit_card_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_credit_card"
where credit_card_id_WID is not null
group by credit_card_id_WID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.577 seconds
16:22:22  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172: Close
16:22:22  15 of 24 PASS unique_dim_address_INTEGRATION_ID ................................ [PASS in 0.63s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172
16:22:22  Began running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
16:22:22  19 of 24 START test unique_dim_customer_INTEGRATION_ID ......................... [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_INTEGRATION_ID.ab0b1bd172, now test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"
16:22:22  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_customer"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.633 seconds
16:22:22  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978: Close
16:22:22  16 of 24 PASS unique_dim_address_address_id_WID ................................ [PASS in 0.69s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978
16:22:22  Began running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
16:22:22  20 of 24 START test unique_dim_customer_customer_id_WID ........................ [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_address_address_id_WID.f1f7f1c978, now test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"
16:22:22  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_customer"
where customer_id_WID is not null
group by customer_id_WID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.479 seconds
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d: Close
16:22:22  17 of 24 PASS unique_dim_credit_card_INTEGRATION_ID ............................ [PASS in 0.52s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d
16:22:22  Began running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
16:22:22  21 of 24 START test unique_dim_order_status_INTEGRATION_ID ..................... [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_INTEGRATION_ID.0d06642d2d, now test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"
16:22:22  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_order_status"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.522 seconds
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b: Close
16:22:22  18 of 24 PASS unique_dim_credit_card_credit_card_id_WID ........................ [PASS in 0.55s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b
16:22:22  Began running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
16:22:22  22 of 24 START test unique_dim_order_status_order_status_id_WID ................ [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_credit_card_credit_card_id_WID.4ef5f3742b, now test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"
16:22:22  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_status_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_order_status"
where order_status_id_WID is not null
group by order_status_id_WID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.470 seconds
16:22:22  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165: Close
16:22:22  19 of 24 PASS unique_dim_customer_INTEGRATION_ID ............................... [PASS in 0.51s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165
16:22:22  Began running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
16:22:22  23 of 24 START test unique_dim_product_INTEGRATION_ID .......................... [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_customer_INTEGRATION_ID.7d72774165, now test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"
16:22:22  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    INTEGRATION_ID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_product"
where INTEGRATION_ID is not null
group by INTEGRATION_ID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:22  SQL status: SUCCESS in 0.482 seconds
16:22:22  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: ROLLBACK
16:22:22  On test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987: Close
16:22:22  20 of 24 PASS unique_dim_customer_customer_id_WID .............................. [PASS in 0.51s]
16:22:22  Finished running node test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987
16:22:22  Began running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
16:22:22  24 of 24 START test unique_dim_product_product_id_WID .......................... [RUN]
16:22:22  Re-using an available connection from the pool (formerly test.dbt_trino_project.unique_dim_customer_customer_id_WID.4fee480987, now test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6)
16:22:22  Began compiling node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
16:22:22  Writing injected SQL for node "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
16:22:22  Began executing node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
16:22:22  Writing runtime sql for node "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
16:22:22  Using trino connection "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"
16:22:22  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id_WID as unique_field,
    count(*) as n_records

from "iceberg"."gold"."dim_product"
where product_id_WID is not null
group by product_id_WID
having count(*) > 1



      
    ) dbt_internal_test
16:22:22  Opening a new connection, currently in state closed
16:22:23  SQL status: SUCCESS in 0.505 seconds
16:22:23  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: ROLLBACK
16:22:23  On test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477: Close
16:22:23  21 of 24 PASS unique_dim_order_status_INTEGRATION_ID ........................... [PASS in 0.56s]
16:22:23  Finished running node test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477
16:22:23  SQL status: SUCCESS in 0.480 seconds
16:22:23  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: ROLLBACK
16:22:23  On test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882: Close
16:22:23  22 of 24 PASS unique_dim_order_status_order_status_id_WID ...................... [PASS in 0.51s]
16:22:23  Finished running node test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882
16:22:23  SQL status: SUCCESS in 0.364 seconds
16:22:23  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: ROLLBACK
16:22:23  On test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5: Close
16:22:23  23 of 24 PASS unique_dim_product_INTEGRATION_ID ................................ [PASS in 0.39s]
16:22:23  Finished running node test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5
16:22:23  SQL status: SUCCESS in 0.391 seconds
16:22:23  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: ROLLBACK
16:22:23  On test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6: Close
16:22:23  24 of 24 PASS unique_dim_product_product_id_WID ................................ [PASS in 0.43s]
16:22:23  Finished running node test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6
16:22:23  On master: COMMIT
16:22:23  Connection 'master' was properly closed.
16:22:23  Connection 'test.dbt_trino_project.unique_dim_order_status_INTEGRATION_ID.69614b9477' was properly closed.
16:22:23  Connection 'test.dbt_trino_project.unique_dim_product_product_id_WID.4b563d82a6' was properly closed.
16:22:23  Connection 'test.dbt_trino_project.unique_dim_product_INTEGRATION_ID.94600187a5' was properly closed.
16:22:23  Connection 'test.dbt_trino_project.unique_dim_order_status_order_status_id_WID.bf35647882' was properly closed.
16:22:23  
16:22:23  Finished running 24 data tests in 0 hours 0 minutes and 4.22 seconds (4.22s).
16:22:23  Command end result
16:22:23  
16:22:23  Completed successfully
16:22:23  
16:22:23  Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
16:22:23  Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.3817363, "process_user_time": 13.788056, "process_kernel_time": 0.783412, "process_mem_max_rss": "130204", "process_in_blocks": "4440", "process_out_blocks": "3384"}
16:22:23  Command `dbt test` succeeded at 16:22:23.413951 after 5.38 seconds
16:22:23  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518b55db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518c63e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518f664910>]}
16:22:23  Flushing usage events
[0m01:32:55.034514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21ea84dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21ea84250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21ea87550>]}


============================== 01:32:55.043838 | 53dd44c3-01e6-4012-a3af-23a0d83b684c ==============================
[0m01:32:55.043838 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:32:55.044764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8088', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:32:55.517524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53dd44c3-01e6-4012-a3af-23a0d83b684c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21e7c4e90>]}
[0m01:32:55.620584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53dd44c3-01e6-4012-a3af-23a0d83b684c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2207e8690>]}
[0m07:17:21.962591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6434e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f64397290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f64369f90>]}


============================== 07:17:21.990259 | 09d31ca6-82dc-4002-aaf5-27ff175a178e ==============================
[0m07:17:21.990259 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:17:21.991076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --target dev --exclude {{ params.exclude }} --select {{ params.select }} --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m07:17:22.360729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f64345b10>]}
[0m07:17:22.457703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6577c650>]}
[0m07:17:22.458672 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:17:22.587215 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:17:22.820733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m07:17:22.821895 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_project://models/marts/dim_customer.sql
[0m07:17:22.822550 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_project://models/marts/fact_sales.sql
[0m07:17:22.823153 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_project://models/marts/dim_address.sql
[0m07:17:22.823773 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_project://models/marts/dim_product.sql
[0m07:17:22.824358 [debug] [MainThread]: Partial parsing: updated file: dbt_trino_project://models/marts/dim_credit_card.sql
[0m07:17:23.291823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:17:23.292560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f65741310>]}
[0m07:17:23.674022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m07:17:23.693961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f63f18d90>]}
[0m07:17:23.861424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f63b67dd0>]}
[0m07:17:23.862175 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:17:23.862677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d31ca6-82dc-4002-aaf5-27ff175a178e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f63aa9210>]}
[0m07:17:23.863709 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:17:23.864446 [warn ] [MainThread]: The selection criterion 'params.select' does not match any enabled nodes
[0m07:17:23.865343 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:17:23.866082 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:17:23.866802 [warn ] [MainThread]: The selection criterion 'params.exclude' does not match any enabled nodes
[0m07:17:23.867560 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:17:23.869183 [info ] [MainThread]: 
[0m07:17:23.869705 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:17:23.870377 [debug] [MainThread]: Command end result
[0m07:17:23.922955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0393317, "process_user_time": 4.301892, "process_kernel_time": 0.48762, "process_mem_max_rss": "176032", "process_in_blocks": "67480", "process_out_blocks": "8056"}
[0m07:17:23.923718 [debug] [MainThread]: Command `dbt run` succeeded at 07:17:23.923592 after 2.04 seconds
[0m07:17:23.924227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f682a85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6821bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6821bd90>]}
[0m07:17:23.924769 [debug] [MainThread]: Flushing usage events
[0m07:29:31.144031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749c8ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749fc2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749c89650>]}


============================== 07:29:31.155487 | 19c3add1-0981-40f0-ad59-d6d59029a01c ==============================
[0m07:29:31.155487 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:29:31.156350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --target dev --exclude  --select dim_address', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:31.501366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749c89bd0>]}
[0m07:29:31.607241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f574ba716d0>]}
[0m07:29:31.608590 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:29:31.741848 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:29:31.952660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:31.953410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:31.962013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m07:29:32.018928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749815690>]}
[0m07:29:32.196745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f574b636490>]}
[0m07:29:32.197775 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:29:32.198352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749a1ef50>]}
[0m07:29:32.199848 [warn ] [MainThread]: The selection criterion '' does not match any enabled nodes
[0m07:29:32.201678 [info ] [MainThread]: 
[0m07:29:32.202500 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m07:29:32.203819 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m07:29:32.308479 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m07:29:32.309058 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m07:29:32.309549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:32.904383 [debug] [ThreadPool]: SQL status: SUCCESS in 0.595 seconds
[0m07:29:32.906495 [debug] [ThreadPool]: On list_iceberg: Close
[0m07:29:32.915076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_gold)
[0m07:29:32.938932 [debug] [ThreadPool]: Using trino connection "list_iceberg_gold"
[0m07:29:32.939566 [debug] [ThreadPool]: On list_iceberg_gold: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "connection_name": "list_iceberg_gold"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'gold') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'gold'
[0m07:29:32.940033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:33.507066 [debug] [ThreadPool]: SQL status: SUCCESS in 0.567 seconds
[0m07:29:33.508822 [debug] [ThreadPool]: On list_iceberg_gold: ROLLBACK
[0m07:29:33.509302 [debug] [ThreadPool]: On list_iceberg_gold: Close
[0m07:29:33.511242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5749ae72d0>]}
[0m07:29:33.511897 [debug] [MainThread]: On master: COMMIT
[0m07:29:33.512481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:33.512993 [info ] [MainThread]: 
[0m07:29:33.524711 [debug] [Thread-1 (]: Began running node model.dbt_trino_project.dim_address
[0m07:29:33.525573 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.dim_address .................................. [RUN]
[0m07:29:33.526434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_iceberg_gold, now model.dbt_trino_project.dim_address)
[0m07:29:33.526990 [debug] [Thread-1 (]: Began compiling node model.dbt_trino_project.dim_address
[0m07:29:33.545681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_trino_project.dim_address"
[0m07:29:33.547823 [debug] [Thread-1 (]: Began executing node model.dbt_trino_project.dim_address
[0m07:29:33.674665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_trino_project.dim_address"
[0m07:29:33.679760 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_project.dim_address"
[0m07:29:33.680449 [debug] [Thread-1 (]: On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

  
    

    create table "iceberg"."gold"."dim_address__dbt_tmp"
      
      
    as (
      

with stg_address as (
  select * from "iceberg"."silver"."silver_person_address"
),
stg_stateprovince as (
  select * from "iceberg"."silver"."silver_person_stateprovince"
),
stg_countryregion as (
  select * from "iceberg"."silver"."silver_person_countryregion"
)

select
  lower(to_hex(md5(to_utf8(cast(coalesce(cast(a.addressid as varchar), '_dbt_utils_surrogate_key_null_') as varchar))))) as address_id_WID,
  a.addressid as INTEGRATION_ID,

  -- Thuộc tính mô tả
  a.addressline1 AS address_line_1,
  a.addressline2 AS address_line_2,
  a.city,
  a.postalcode AS postal_code,

  -- State/Province
  cast(a.stateprovinceid as bigint) as state_province_id,
  sp.stateprovincecode AS state_province_code,
  sp.name as state_province_name,

  -- Country/Region
  sp.countryregioncode AS country_region_code,
  cr.name as country_name,

  -- Phụ trợ
  -- a.spatiallocation,
  -- a.rowguid,
  a.modifieddate

from stg_address a
left join stg_stateprovince sp
  on cast(a.stateprovinceid as bigint) = sp.stateprovinceid
left join stg_countryregion cr
  on sp.countryregioncode = cr.countryregioncode
    )
[0m07:29:33.681015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:42.361589 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.680 seconds
[0m07:29:42.372462 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_project.dim_address"
[0m07:29:42.373300 [debug] [Thread-1 (]: On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */
alter table "iceberg"."gold"."dim_address__dbt_tmp" rename to "iceberg"."gold"."dim_address"
[0m07:29:42.932880 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.559 seconds
[0m07:29:42.942859 [debug] [Thread-1 (]: Applying DROP to: "iceberg"."gold"."dim_address__dbt_backup"
[0m07:29:42.945905 [debug] [Thread-1 (]: Using trino connection "model.dbt_trino_project.dim_address"
[0m07:29:42.946521 [debug] [Thread-1 (]: On model.dbt_trino_project.dim_address: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_trino_project", "target_name": "dev", "node_id": "model.dbt_trino_project.dim_address"} */

    drop table if exists "iceberg"."gold"."dim_address__dbt_backup"
[0m07:29:43.105605 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.158 seconds
[0m07:29:43.130682 [debug] [Thread-1 (]: On model.dbt_trino_project.dim_address: ROLLBACK
[0m07:29:43.131299 [debug] [Thread-1 (]: On model.dbt_trino_project.dim_address: Close
[0m07:29:43.134572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19c3add1-0981-40f0-ad59-d6d59029a01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5748a56f50>]}
[0m07:29:43.135460 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.dim_address ............................. [[32mSUCCESS[0m in 9.61s]
[0m07:29:43.136293 [debug] [Thread-1 (]: Finished running node model.dbt_trino_project.dim_address
[0m07:29:43.138664 [debug] [MainThread]: On master: COMMIT
[0m07:29:43.139252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:43.139670 [debug] [MainThread]: Connection 'model.dbt_trino_project.dim_address' was properly closed.
[0m07:29:43.140123 [info ] [MainThread]: 
[0m07:29:43.140615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m07:29:43.141633 [debug] [MainThread]: Command end result
[0m07:29:43.200490 [info ] [MainThread]: 
[0m07:29:43.201267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:43.201769 [info ] [MainThread]: 
[0m07:29:43.202288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:43.204503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.142664, "process_user_time": 4.636123, "process_kernel_time": 0.987117, "process_mem_max_rss": "136132", "process_in_blocks": "42128", "process_out_blocks": "2840"}
[0m07:29:43.205260 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:43.205132 after 12.14 seconds
[0m07:29:43.205766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f574dbffc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f574dbffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f574ddbaf90>]}
[0m07:29:43.206250 [debug] [MainThread]: Flushing usage events
[0m07:44:44.658015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0391bb1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0391bb11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03919bef50>]}


============================== 07:44:44.666375 | d07f31e1-5895-48a7-bfb9-443211b5dff0 ==============================
[0m07:44:44.666375 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:44:44.667183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:44.940975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd07f31e1-5895-48a7-bfb9-443211b5dff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03918bbc10>]}
[0m07:44:45.010359 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-37xdu7jn'
[0m07:44:45.011001 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:44:45.212618 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:44:45.213742 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:44:45.262792 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:44:45.268647 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:44:45.980871 [info ] [MainThread]: Installed from version 1.1.1
[0m07:44:45.981525 [info ] [MainThread]: Updated version available: 1.3.2
[0m07:44:45.982075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd07f31e1-5895-48a7-bfb9-443211b5dff0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0391920810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03918a7010>]}
[0m07:44:45.982587 [info ] [MainThread]: 
[0m07:44:45.983071 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:44:45.984707 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4047549, "process_user_time": 2.416078, "process_kernel_time": 0.620344, "process_mem_max_rss": "115236", "process_in_blocks": "26072", "process_out_blocks": "2232"}
[0m07:44:45.985354 [debug] [MainThread]: Command `dbt deps` succeeded at 07:44:45.985235 after 1.41 seconds
[0m07:44:45.985815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039597c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03958efa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0395ad28d0>]}
[0m07:44:45.986293 [debug] [MainThread]: Flushing usage events
[0m07:44:53.604212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac6406d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac68de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac641450>]}


============================== 07:44:53.614290 | b0375ffa-7095-48f8-8985-442a8ec3e2e3 ==============================
[0m07:44:53.614290 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:44:53.645997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --target dev --exclude {{ params.exclude }} --select {{ params.select }} --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m07:44:54.001014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0375ffa-7095-48f8-8985-442a8ec3e2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac44cb10>]}
[0m07:44:54.102922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0375ffa-7095-48f8-8985-442a8ec3e2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcae3ad910>]}
[0m07:44:54.103802 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:44:54.231644 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:44:54.413698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:54.414333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:54.423482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m07:44:54.479768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0375ffa-7095-48f8-8985-442a8ec3e2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac1b7650>]}
[0m07:44:54.648669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0375ffa-7095-48f8-8985-442a8ec3e2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac428150>]}
[0m07:44:54.649439 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:44:54.649927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0375ffa-7095-48f8-8985-442a8ec3e2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac47a890>]}
[0m07:44:54.650971 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:44:54.651654 [warn ] [MainThread]: The selection criterion 'params.select' does not match any enabled nodes
[0m07:44:54.652323 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:44:54.652984 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:44:54.653633 [warn ] [MainThread]: The selection criterion 'params.exclude' does not match any enabled nodes
[0m07:44:54.654297 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:44:54.655985 [info ] [MainThread]: 
[0m07:44:54.656511 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:54.658687 [debug] [MainThread]: Command end result
[0m07:44:54.712294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.196018, "process_user_time": 3.292019, "process_kernel_time": 0.399032, "process_mem_max_rss": "115344", "process_in_blocks": "6624", "process_out_blocks": "2768"}
[0m07:44:54.713107 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:54.712972 after 1.20 seconds
[0m07:44:54.713635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcac962950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb05b8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb052b250>]}
[0m07:44:54.714144 [debug] [MainThread]: Flushing usage events
[0m07:44:59.697729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0d18c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0d3853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0d18e190>]}


============================== 07:44:59.706156 | bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1 ==============================
[0m07:44:59.706156 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:44:59.707065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev --exclude {{ params.exclude }} --select {{ params.select }}', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:59.977486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0d1f6ed0>]}
[0m07:45:00.072931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0ef71610>]}
[0m07:45:00.073919 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:45:00.192972 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:45:00.357000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:00.357592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:00.366257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m07:45:00.420989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0cc9ca10>]}
[0m07:45:00.588324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0c8f91d0>]}
[0m07:45:00.589060 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:45:00.589550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd0badd5-7ea8-4f68-8fbe-bd895c7cf7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0ce2b850>]}
[0m07:45:00.590558 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:45:00.591286 [warn ] [MainThread]: The selection criterion 'params.select' does not match any enabled nodes
[0m07:45:00.591937 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:45:00.592632 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:45:00.593321 [warn ] [MainThread]: The selection criterion 'params.exclude' does not match any enabled nodes
[0m07:45:00.593976 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:45:00.595542 [info ] [MainThread]: 
[0m07:45:00.596053 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:45:00.598486 [debug] [MainThread]: Command end result
[0m07:45:00.648542 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0272882, "process_user_time": 3.033219, "process_kernel_time": 0.387455, "process_mem_max_rss": "115844", "process_in_blocks": "7784", "process_out_blocks": "2768"}
[0m07:45:00.649295 [debug] [MainThread]: Command `dbt test` succeeded at 07:45:00.649171 after 1.03 seconds
[0m07:45:00.649826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c110ebd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c110eb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c110ebbd0>]}
[0m07:45:00.650351 [debug] [MainThread]: Flushing usage events
[0m07:48:36.225170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977ee1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977ee18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977ee0c10>]}


============================== 07:48:36.261096 | c9564a1e-06e2-4aab-8289-1f6dcd970d1a ==============================
[0m07:48:36.261096 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:48:36.261981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/dbt --target dev', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:48:36.525233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9564a1e-06e2-4aab-8289-1f6dcd970d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977f37f90>]}
[0m07:48:36.602939 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2_tla5lp'
[0m07:48:36.603714 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:48:36.755100 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:48:36.756087 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:48:36.812059 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:48:36.818126 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:48:37.550491 [info ] [MainThread]: Installed from version 1.1.1
[0m07:48:37.551108 [info ] [MainThread]: Updated version available: 1.3.2
[0m07:48:37.551649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9564a1e-06e2-4aab-8289-1f6dcd970d1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977e07690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977ed95d0>]}
[0m07:48:37.552168 [info ] [MainThread]: 
[0m07:48:37.552648 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m07:48:37.553998 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4165268, "process_user_time": 2.67061, "process_kernel_time": 0.518984, "process_mem_max_rss": "177660", "process_in_blocks": "68056", "process_out_blocks": "6224"}
[0m07:48:37.554696 [debug] [MainThread]: Command `dbt deps` succeeded at 07:48:37.554555 after 1.42 seconds
[0m07:48:37.555198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc977f37f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97be884d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97bdfb010>]}
[0m07:48:37.555690 [debug] [MainThread]: Flushing usage events
[0m07:48:41.709461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2d90c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2da7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2d91c90>]}


============================== 07:48:41.717061 | 07620eb0-b056-41cc-917a-8160d6964b97 ==============================
[0m07:48:41.717061 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:48:41.717943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --target dev --exclude {{ params.exclude }} --select {{ params.select }} --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:48:41.995513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07620eb0-b056-41cc-917a-8160d6964b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2f85910>]}
[0m07:48:42.733978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07620eb0-b056-41cc-917a-8160d6964b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d4af9710>]}
[0m07:48:42.734914 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:48:45.577156 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:48:45.799247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:48:45.799843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:48:45.808542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.staging
- models.dbt_trino_project.intermediate
[0m07:48:45.864830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07620eb0-b056-41cc-917a-8160d6964b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2eaf6d0>]}
[0m07:48:46.021192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07620eb0-b056-41cc-917a-8160d6964b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2b78150>]}
[0m07:48:46.021964 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:48:46.022462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07620eb0-b056-41cc-917a-8160d6964b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2b4e7d0>]}
[0m07:48:46.023506 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:48:46.024239 [warn ] [MainThread]: The selection criterion 'params.select' does not match any enabled nodes
[0m07:48:46.024922 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:48:46.025609 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:48:46.026267 [warn ] [MainThread]: The selection criterion 'params.exclude' does not match any enabled nodes
[0m07:48:46.026948 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:48:46.028563 [info ] [MainThread]: 
[0m07:48:46.029048 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:48:46.031232 [debug] [MainThread]: Command end result
[0m07:48:46.081788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1127069, "process_user_time": 3.054665, "process_kernel_time": 0.201406, "process_mem_max_rss": "177252", "process_in_blocks": "4008", "process_out_blocks": "2768"}
[0m07:48:46.082550 [debug] [MainThread]: Command `dbt run` succeeded at 07:48:46.082423 after 1.11 seconds
[0m07:48:46.083081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d30b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d6d08750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d6c7b250>]}
[0m07:48:46.083660 [debug] [MainThread]: Flushing usage events
[0m07:48:50.156120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0b881d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee28a50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0ea2a10>]}


============================== 07:48:50.163336 | 955a2e6c-e748-4826-936a-a16e34a894fa ==============================
[0m07:48:50.163336 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:48:50.164124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev --exclude {{ params.exclude }} --select {{ params.select }}', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:48:50.439049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '955a2e6c-e748-4826-936a-a16e34a894fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee08c4b10>]}
[0m07:48:50.536453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '955a2e6c-e748-4826-936a-a16e34a894fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee26dd3d0>]}
[0m07:48:50.537367 [info ] [MainThread]: Registered adapter: trino=1.8.0
[0m07:48:50.653234 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m07:48:50.817506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:48:50.818222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:48:50.826872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_trino_project.intermediate
- models.dbt_trino_project.staging
[0m07:48:50.883362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '955a2e6c-e748-4826-936a-a16e34a894fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0bea550>]}
[0m07:48:51.056021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '955a2e6c-e748-4826-936a-a16e34a894fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee02d5e10>]}
[0m07:48:51.056894 [info ] [MainThread]: Found 6 models, 24 data tests, 15 sources, 564 macros
[0m07:48:51.057453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955a2e6c-e748-4826-936a-a16e34a894fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0743d90>]}
[0m07:48:51.058895 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:48:51.059803 [warn ] [MainThread]: The selection criterion 'params.select' does not match any enabled nodes
[0m07:48:51.060619 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:48:51.061391 [warn ] [MainThread]: The selection criterion '{{' does not match any enabled nodes
[0m07:48:51.062160 [warn ] [MainThread]: The selection criterion 'params.exclude' does not match any enabled nodes
[0m07:48:51.062850 [warn ] [MainThread]: The selection criterion '}}' does not match any enabled nodes
[0m07:48:51.064671 [info ] [MainThread]: 
[0m07:48:51.065638 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:48:51.067950 [debug] [MainThread]: Command end result
[0m07:48:51.121897 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0415407, "process_user_time": 2.99457, "process_kernel_time": 0.267173, "process_mem_max_rss": "176612", "process_in_blocks": "1416", "process_out_blocks": "2768"}
[0m07:48:51.122702 [debug] [MainThread]: Command `dbt test` succeeded at 07:48:51.122565 after 1.04 seconds
[0m07:48:51.123262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0ea2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee0bce710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee4aabd50>]}
[0m07:48:51.123795 [debug] [MainThread]: Flushing usage events
