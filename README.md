ğŸ—ï¸ Lakehouse Project

ğŸ“ Dáº«n Dáº¯t: HÃ nh TrÃ¬nh PhÃ¡t Triá»ƒn cá»§a Kiáº¿n TrÃºc Dá»¯ Liá»‡u
- Khá»Ÿi Äáº§u vá»›i Data Warehouse (Kho Dá»¯ Liá»‡u)
Trong giai Ä‘oáº¡n Ä‘áº§u cá»§a ká»· nguyÃªn dá»¯ liá»‡u, cÃ¡c doanh nghiá»‡p nháº­n ra ráº±ng viá»‡c phÃ¢n tÃ­ch cÃ¡c bÃ¡o cÃ¡o phá»©c táº¡p trá»±c tiáº¿p trÃªn cÆ¡ sá»Ÿ dá»¯ liá»‡u giao dá»‹ch hÃ ng ngÃ y lÃ  khÃ´ng kháº£ thi. Äiá»u nÃ y lÃ m giáº£m hiá»‡u suáº¥t há»‡ thá»‘ng kinh doanh cá»‘t lÃµi.

Váº¥n Ä‘á» Ä‘áº·t ra: Cáº§n má»™t nÆ¡i riÃªng biá»‡t, cÃ³ cáº¥u trÃºc Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÃ m sáº¡ch, sáºµn sÃ ng cho cÃ¡c phÃ¢n tÃ­ch chuyÃªn sÃ¢u (OLAP).

Giáº£i phÃ¡p: Data Warehouse (DW) ra Ä‘á»i. DW mang láº¡i Ä‘á»™ tin cáº­y cao nhá» kháº£ nÄƒng thá»±c thi cáº¥u trÃºc cháº·t cháº½ (Schema-on-Write) vÃ  Ä‘áº£m báº£o cÃ¡c giao dá»‹ch ACID, lÃ½ tÆ°á»Ÿng cho Business Intelligence (BI) vÃ  bÃ¡o cÃ¡o tÃ i chÃ­nh quan trá»ng.

NhÆ°ng sau Ä‘Ã³... Khi lÆ°á»£ng dá»¯ liá»‡u bÃ¹ng ná»•, Ä‘áº·c biá»‡t lÃ  cÃ¡c loáº¡i dá»¯ liá»‡u má»›i nhÆ° log, sensor, hÃ¬nh áº£nh, vÃ  video (dá»¯ liá»‡u phi cáº¥u trÃºc), DW báº¯t Ä‘áº§u bá»™c lá»™ nhÆ°á»£c Ä‘iá»ƒm. NÃ³ quÃ¡ Ä‘áº¯t Ä‘á», quÃ¡ cá»©ng nháº¯c, vÃ  gáº§n nhÆ° khÃ´ng thá»ƒ xá»­ lÃ½ cÃ¡c loáº¡i dá»¯ liá»‡u thÃ´ nÃ y.

- Sá»± Trá»—i Dáº­y cá»§a Data Lake (Há»“ Dá»¯ Liá»‡u)
Äá»ƒ Ä‘á»‘i phÃ³ vá»›i sá»± bÃ¹ng ná»• dá»¯ liá»‡u thÃ´ vÃ  nhu cáº§u vá» má»™t ná»n táº£ng chi phÃ­ tháº¥p cho Machine Learning (ML) vÃ  Data Science, Data Lake xuáº¥t hiá»‡n.

Váº¥n Ä‘á» Ä‘áº·t ra: Cáº§n má»™t nÆ¡i cÃ³ kháº£ nÄƒng lÆ°u trá»¯ má»i loáº¡i dá»¯ liá»‡u á»Ÿ dáº¡ng thÃ´ vá»›i chi phÃ­ cá»±c tháº¥p, khÃ´ng giá»›i háº¡n dung lÆ°á»£ng, vÃ  linh hoáº¡t cho cÃ¡c thuáº­t toÃ¡n AI/ML.

Giáº£i phÃ¡p: Data Lake (DL) Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn ná»n táº£ng lÆ°u trá»¯ Ä‘á»‘i tÆ°á»£ng (vÃ­ dá»¥: S3, ADLS). DL cho phÃ©p chÃºng ta lÆ°u trá»¯ dá»¯ liá»‡u vá»›i nguyÃªn táº¯c Schema-on-Read (Ä‘á»‹nh nghÄ©a cáº¥u trÃºc khi Ä‘á»c), mang láº¡i sá»± linh hoáº¡t tuyá»‡t Ä‘á»‘i.

Tuy nhiÃªn, Ä‘Ã¢y lÃ  rÃ o cáº£n... Sá»± linh hoáº¡t Ä‘Ã³ pháº£i tráº£ giÃ¡ báº±ng Ä‘á»™ tin cáº­y. Data Lake thiáº¿u cÃ¡c tÃ­nh nÄƒng quáº£n lÃ½ giao dá»‹ch (ACID), dáº«n Ä‘áº¿n váº¥n Ä‘á» vá» cháº¥t lÆ°á»£ng vÃ  tÃ­nh nháº¥t quÃ¡n cá»§a dá»¯ liá»‡u. Viá»‡c thá»±c hiá»‡n cÃ¡c bÃ¡o cÃ¡o BI nghiÃªm ngáº·t trÃªn Data Lake trá»Ÿ nÃªn rá»§i ro vÃ  khÃ³ khÄƒn, thÆ°á»ng biáº¿n nÃ³ thÃ nh "Data Swamp" (Äáº§m láº§y dá»¯ liá»‡u).

- Nhu Cáº§u Há»£p Nháº¥t vÃ  Sá»± Ra Äá»i cá»§a Lakehouse
CÃ¡c tá»• chá»©c tháº¥y mÃ¬nh bá»‹ káº¹t trong viá»‡c pháº£i duy trÃ¬ cáº£ hai há»‡ thá»‘ng: DW cho BI Ä‘Ã¡ng tin cáº­y vÃ  DL cho AI/ML linh hoáº¡t.

Váº¥n Ä‘á» Ä‘áº·t ra: Viá»‡c duy trÃ¬ hai há»‡ thá»‘ng song song táº¡o ra sá»± phá»©c táº¡p, trÃ¹ng láº·p dá»¯ liá»‡u, vÃ  Ä‘á»™ trá»… cao do pháº£i di chuyá»ƒn dá»¯ liá»‡u liÃªn tá»¥c giá»¯a hai nÆ¡i. Chi phÃ­ váº­n hÃ nh tÄƒng lÃªn, vÃ  viá»‡c táº¡o ra má»™t nguá»“n dá»¯ liá»‡u chÃ¢n tháº­t duy nháº¥t (Single Source of Truth) trá»Ÿ nÃªn báº¥t kháº£ thi.

Giáº£i phÃ¡p Ä‘á»™t phÃ¡: Kiáº¿n trÃºc Data Lakehouse ra Ä‘á»i Ä‘á»ƒ giáº£i quyáº¿t triá»‡t Ä‘á»ƒ váº¥n Ä‘á» nÃ y.

Lakehouse lÃ  sá»± káº¿t há»£p tá»‘i Æ°u: NÃ³ táº­n dá»¥ng chi phÃ­ tháº¥p vÃ  kháº£ nÄƒng má»Ÿ rá»™ng cá»§a Data Lake, nhÆ°ng bá»• sung má»™t lá»›p quáº£n lÃ½ giao dá»‹ch (Transaction Layer) (vÃ­ dá»¥: Delta Lake, Iceberg) Ä‘á»ƒ mang láº¡i tÃ­nh nháº¥t quÃ¡n, ACID, vÃ  cáº¥u trÃºc cáº§n thiáº¿t cá»§a Data Warehouse.

Káº¿t quáº£: Lakehouse cho phÃ©p chÃºng ta thá»±c hiá»‡n táº¥t cáº£ cÃ¡c tÃ¡c vá»¥ (BI, AI/ML, Streaming) trÃªn má»™t báº£n sao dá»¯ liá»‡u duy nháº¥t, loáº¡i bá» sá»± phá»©c táº¡p, giáº£m thiá»ƒu chi phÃ­ vÃ  tÄƒng tá»‘c Ä‘á»™ phÃ¢n tÃ­ch cho toÃ n bá»™ doanh nghiá»‡p.



<img width="1022" height="603" alt="image" src="https://github.com/user-attachments/assets/ab61e5a0-1813-42ac-9c7a-7a6783bae167" />

MÃ´ hÃ¬nh tá»• chá»©c dá»¯ liá»‡u theo ba táº§ng:
Bronze â€“ dá»¯ liá»‡u thÃ´, náº¡p tá»« nguá»“n gá»‘c.
Silver â€“ dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÃ m sáº¡ch vÃ  chuáº©n hÃ³a schema.
Gold â€“ dá»¯ liá»‡u tá»•ng há»£p, phá»¥c vá»¥ phÃ¢n tÃ­ch vÃ  dashboard.


âš™ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng
| ThÃ nh pháº§n               | Vai trÃ²            | MÃ´ táº£                                                                                                   |
| ------------------------ | ------------------ | ------------------------------------------------------------------------------------------------------- |
| **MinIO**                | Data Lake          | Object storage tÆ°Æ¡ng thÃ­ch S3, lÆ°u dá»¯ liá»‡u á»Ÿ cÃ¡c táº§ng bronze/silver/gold.                               |
| **Apache Iceberg**       | Table Format       | Quáº£n lÃ½ schema, versioning, partition vÃ  ACID transaction trÃªn data lake.                               |
| **Trino**                | Query Engine       | Xá»­ lÃ½ truy váº¥n SQL phÃ¢n tÃ¡n, Ä‘á»c báº£ng Iceberg thÃ´ng qua Hive Metastore vÃ  MinIO.                        |
| **Hive Metastore (HMS)** | Metadata Catalog   | LÆ°u trá»¯ metadata (schema, partition, snapshot) cho cÃ¡c báº£ng Iceberg, lÃ m cáº§u ná»‘i giá»¯a Trino vÃ  Iceberg. |
| **Airflow**              | Orchestration      | Äiá»u phá»‘i vÃ  tá»± Ä‘á»™ng hÃ³a pipeline ETL/ELT.                                                              |
| **DBT (optional)**       | Transformation     | Quáº£n lÃ½ logic biáº¿n Ä‘á»•i dá»¯ liá»‡u SQL á»Ÿ táº§ng Silver/Gold, dÃ¹ng Trino lÃ m engine.                           |
| **Python utilities**     | Tooling            | Há»— trá»£ Ä‘á»c/ghi file, Ä‘Äƒng kÃ½ Iceberg schema, chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u giá»¯a cÃ¡c táº§ng.                          |
| **Metabase (optional)**  | BI / Visualization | Káº¿t ná»‘i vá»›i Trino Ä‘á»ƒ trá»±c quan hÃ³a dá»¯ liá»‡u qua dashboard, chart vÃ  bÃ¡o cÃ¡o.                             |




ğŸ“¦ Dá»¯ liá»‡u sá»­ dá»¥ng: AdventureWorks

Dá»± Ã¡n sá»­ dá»¥ng AdventureWorks, bá»™ dá»¯ liá»‡u máº«u ná»•i tiáº¿ng cá»§a Microsoft mÃ´ phá»ng hoáº¡t Ä‘á»™ng cá»§a má»™t cÃ´ng ty sáº£n xuáº¥t vÃ  bÃ¡n hÃ ng toÃ n cáº§u.
AdventureWorks chá»©a dá»¯ liá»‡u Ä‘a dáº¡ng, phÃ¹ há»£p cho cáº£ ká»¹ thuáº­t Data Modeling, ETL, vÃ  BI:

Production â€“ sáº£n pháº©m, danh má»¥c, tá»“n kho, quy trÃ¬nh sáº£n xuáº¥t.

Sales â€“ khÃ¡ch hÃ ng, Ä‘Æ¡n hÃ ng, thanh toÃ¡n, tháº» tÃ­n dá»¥ng.

Person â€“ thÃ´ng tin nhÃ¢n viÃªn, Ä‘á»‹a chá»‰, quá»‘c gia, vÃ¹ng Ä‘á»‹a lÃ½.

HumanResources â€“ dá»¯ liá»‡u nhÃ¢n sá»±, phÃ²ng ban, chá»©c vá»¥.

Purchasing â€“ nhÃ  cung cáº¥p, phiáº¿u mua hÃ ng.

Trong dá»± Ã¡n nÃ y:

Dá»¯ liá»‡u raw CSV/Parquet Ä‘Æ°á»£c lÆ°u á»Ÿ táº§ng Bronze (trÃªn MinIO).

Sau Ä‘Ã³ Ä‘Æ°á»£c chuáº©n hÃ³a vÃ  tÃ¡ch quan há»‡ thÃ nh cÃ¡c báº£ng Silver (Iceberg).

Cuá»‘i cÃ¹ng, dá»¯ liá»‡u Ä‘Æ°á»£c tá»•ng há»£p vÃ  tÃ­nh toÃ¡n KPI á»Ÿ táº§ng Gold phá»¥c vá»¥ bÃ¡o cÃ¡o.



Bronze - dá»¯ liá»‡u raw Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ trÃªn MiniO 

<img width="601" height="284" alt="image" src="https://github.com/user-attachments/assets/58dc091d-6309-454e-9527-8a3ff0021076" />

Silver - Ä‘Äƒng kÃ½ báº£ng vÃ  xá»­ lÃ½, lÃ m sáº¡ch dá»¯ liá»‡u 

<img width="574" height="393" alt="image" src="https://github.com/user-attachments/assets/66db2bc7-4feb-4f70-ba90-df8152f5c01c" />

Gold â€“ dá»¯ liá»‡u tá»•ng há»£p, phá»¥c vá»¥ phÃ¢n tÃ­ch vÃ  dashboard.
sá»­ dá»¥ng dbt vÃ  airflow Ä‘á»ƒ modeling cÃ¡c báº£ng dá»¯ liá»‡u vá» dim vÃ  fact vÃ  lÃ m dashboard cÆ¡ báº£n 

<img width="582" height="191" alt="image" src="https://github.com/user-attachments/assets/5f25ef4c-839a-4701-bd69-0c95ea5dc90b" />

<img width="584" height="464" alt="image" src="https://github.com/user-attachments/assets/f28a85b1-7451-4cf5-bac9-b6dc25c003dc" />





